<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="appTitle">Performance Drafting Assistant</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Arabic font (Noto Sans Arabic) for better display -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        /* Custom Colors inspired by LinkedIn's aesthetic */
        :root {
            --linkedin-blue-primary: #0a66c2; /* LinkedIn's main blue for accents, active states */
            --linkedin-blue-dark: #004182;    /* Darker blue for headers */
            --linkedin-blue-light: #e6f2ff;   /* Very light blue for subtle backgrounds */
            --linkedin-gray-50: #f3f2ef;      /* Main background color */
            --linkedin-gray-100: #e0e0e0;     /* Border colors, light elements */
            --linkedin-gray-200: #c4c4c4;     /* Slightly darker gray for some elements */
            --linkedin-text-dark: #1f1f1f;     /* Dark text */
            --linkedin-text-medium: #6b6b6b;  /* Medium gray text */
            --linkedin-text-light: #999999;   /* Lighter gray for placeholders, hints */
            --linkedin-red: #dc3545;          /* Error/alert red */
            --linkedin-green: #28a745;        /* Success green */
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--linkedin-gray-50);
            color: var(--linkedin-text-dark);
            line-height: 1.5; /* Improved readability */
        }
        html[dir="rtl"] body {
            font-family: 'Noto Sans Arabic', sans-serif;
        }

        /* General Container & Module Styling */
        .app-main-container {
            max-width: 1000px; /* Slightly wider main content area */
            margin: 0 auto; /* Center the container */
            padding: 1.5rem; /* Consistent padding */
        }

        .module-section {
            background-color: #ffffff;
            border-radius: 0.75rem; /* Rounded corners */
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06); /* Subtle shadow */
            padding: 2rem; /* Generous padding */
            margin-bottom: 2rem; /* Space between modules */
            border: 1px solid var(--linkedin-gray-100); /* Light border */
        }

        /* Header Styling */
        .app-header {
            background-color: var(--linkedin-blue-dark); /* Darker blue header */
            color: white;
            padding: 1rem 1.5rem; /* Adjusted padding */
            border-radius: 0.75rem; /* Rounded corners for header */
            margin-bottom: 1.5rem;
            display: flex;
            flex-direction: column; /* Stack elements vertically */
            align-items: center;
            justify-content: center;
            gap: 0; /* Space between elements in header (now 0) */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15); /* Slightly stronger shadow for header */
            text-align: center; /* Center text within header */
        }
        /* Updated font sizes for hierarchy */
        .app-header h1 { /* This is "Employee Performance Drafting Tool" */
            font-size: 1.75rem; /* Smaller than h2 now */
            font-weight: 700;
            margin: 0; /* Explicitly set margin to 0 */
            text-align: center;
        }
        .app-header h2 { /* This is "Employee Performance Hub" */
            font-size: 3.25rem; /* Bigger than h1 now */
            font-weight: 600;
            margin: 0; /* Explicitly set margin to 0 */
            color: white;
        }
        #sudani-logo {
            height: 45px; /* Adjust logo size */
            width: auto;
            filter: brightness(0) invert(1); /* Makes logo white */
            margin: 0; /* Explicitly set margin to 0 */
        }
        /* No need to flip for RTL if using column-reverse or aligning center */
        html[dir="rtl"] .app-header {
            flex-direction: column; /* Keep column direction for RTL */
        }

        /* Navigation Bar Styling */
        .nav-bar {
            background-color: #ffffff;
            padding: 0.75rem 1rem; /* Adjusted padding */
            border-radius: 0.75rem;
            margin-bottom: 1.5rem;
            display: flex;
            justify-content: space-between; /* Space out nav items and language buttons */
            align-items: center;
            flex-wrap: wrap; /* Allow wrapping on small screens */
            gap: 0.5rem; /* Space between nav items/language buttons */
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08), 0 1px 2px rgba(0, 0, 0, 0.04);
        }
        .nav-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center; /* Center nav buttons */
            gap: 0.75rem; /* Space between buttons */
            flex-grow: 1; /* Allow list to take available space */
            list-style: none; /* Remove bullet points */
            padding: 0; /* Remove default padding */
            margin: 0; /* Remove default margin */
        }
        .nav-button {
            padding: 0.6rem 1.2rem; /* Comfortable button padding */
            border-radius: 9999px; /* Pill shape */
            background-color: transparent; /* Default transparent */
            color: var(--linkedin-text-medium); /* Lighter text for inactive */
            font-weight: 500;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            border: 1px solid var(--linkedin-gray-100); /* Subtle border */
            white-space: nowrap; /* Prevent wrapping nav text */
        }
        .nav-button:hover {
            background-color: var(--linkedin-blue-light); /* Light blue hover */
            color: var(--linkedin-blue-primary); /* Primary blue text on hover */
            border-color: var(--linkedin-blue-primary);
        }
        .nav-button.active {
            background-color: var(--linkedin-blue-primary); /* LinkedIn blue for active */
            color: white;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1); /* Slight shadow for active */
            border-color: var(--linkedin-blue-primary);
        }

        /* Language Switcher */
        .language-switcher {
            display: flex;
            gap: 0.5rem;
        }
        .lang-button {
            padding: 0.4rem 0.8rem;
            border-radius: 0.375rem; /* Slightly rounded */
            background-color: var(--linkedin-gray-50);
            color: var(--linkedin-text-medium);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            border: 1px solid var(--linkedin-gray-100);
        }
        .lang-button:hover {
            background-color: var(--linkedin-gray-100);
            color: var(--linkedin-text-dark);
        }
        .lang-button.active {
            background-color: var(--linkedin-blue-primary);
            color: white;
            border-color: var(--linkedin-blue-primary);
        }

        /* Input Group & Fields */
        .input-group {
            margin-bottom: 1.25rem; /* Consistent spacing */
        }
        .input-group label {
            display: block;
            margin-bottom: 0.4rem; /* Closer to input */
            font-weight: 600;
            color: var(--linkedin-text-dark);
            font-size: 0.95rem; /* Slightly larger labels */
        }
        .input-group input[type="text"],
        .input-group input[type="date"],
        .input-group textarea,
        .input-group select {
            width: 100%;
            padding: 0.75rem 1rem; /* Generous padding */
            border: 1px solid var(--linkedin-gray-100);
            border-radius: 0.375rem; /* Consistent roundedness */
            background-color: #ffffff;
            color: var(--linkedin-text-dark);
            transition: all 0.2s ease-in-out;
        }
        .input-group input:focus,
        .input-group textarea:focus,
        .input-group select:focus {
            outline: none;
            border-color: var(--linkedin-blue-primary);
            box-shadow: 0 0 0 2px rgba(10, 102, 194, 0.2); /* LinkedIn-style focus ring */
        }

        /* Checkbox Group */
        .checkbox-group {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            font-size: 0.95rem;
            color: var(--linkedin-text-dark);
        }
        .checkbox-group input[type="checkbox"] {
            margin-right: 0.6rem;
            height: 1.15rem; /* Slightly larger checkbox */
            width: 1.15rem;
            border-color: var(--linkedin-gray-200);
            border-radius: 0.25rem;
            accent-color: var(--linkedin-blue-primary); /* Use accent-color for checkbox fill */
        }

        /* Primary Action Button (Generate) */
        .button-generate {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            padding: 0.85rem 1.5rem; /* Larger button */
            background-color: var(--linkedin-blue-primary);
            color: white;
            font-weight: 600;
            border-radius: 0.375rem;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            border: none;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
        }
        .button-generate:hover {
            background-color: var(--linkedin-blue-dark); /* Darker blue on hover */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
        }
        .button-generate:disabled {
            background-color: var(--linkedin-gray-200); /* Gray for disabled */
            color: var(--linkedin-text-medium);
            cursor: not-allowed;
            box-shadow: none;
        }

        /* Output Area */
        .output-area {
            margin-top: 2rem;
            padding: 2rem;
            background-color: var(--linkedin-blue-light); /* Light blue background for output */
            border-radius: 0.75rem;
            border: 1px solid var(--linkedin-blue-primary); /* Blue border */
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05); /* Inner shadow */
        }
        .output-area h3 {
            color: var(--linkedin-blue-dark); /* Dark blue heading */
            font-size: 1.25rem; /* Larger heading */
            font-weight: 700;
            margin-bottom: 1rem;
        }
        .output-item {
            background-color: #ffffff;
            padding: 1.25rem; /* More padding */
            border-radius: 0.5rem;
            margin-bottom: 1.25rem; /* Space between output items */
            border: 1px solid var(--linkedin-gray-100);
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.05);
        }
        .output-item:last-child {
            margin-bottom: 0;
        }
        .output-item h4 {
            font-weight: 600;
            color: var(--linkedin-text-dark);
            margin-bottom: 0.75rem;
        }
        .output-item p {
            color: var(--linkedin-text-dark);
            font-size: 0.95rem;
        }

        /* Copy Button */
        .copy-button {
            background-color: var(--linkedin-blue-primary); /* Consistent blue */
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
            margin-top: 1rem;
            display: inline-flex; /* Use inline-flex for proper alignment */
            align-items: center;
            gap: 0.5rem;
            border: none;
            float: right; /* Keep it right aligned */
        }
        .copy-button:hover {
            background-color: var(--linkedin-blue-dark);
        }
        .copy-button:disabled {
            background-color: var(--linkedin-gray-200);
            color: var(--linkedin-text-medium);
            cursor: not-allowed;
        }
        html[dir="rtl"] .copy-button {
            float: left; /* Align left for RTL */
        }

        /* Error Message */
        .error-message {
            background-color: var(--linkedin-red);
            color: white;
            padding: 0.75rem 1rem;
            border-radius: 0.375rem;
            margin-bottom: 1rem;
            font-weight: 500;
            text-align: center;
        }

        /* Spinner Icon */
        .spinner {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Icons within buttons */
        .button-generate .icon, .copy-button .icon {
            width: 1.1em; /* Adjust icon size relative to font */
            height: 1.1em;
            margin-right: 0.5em; /* Space between icon and text */
        }
        html[dir="rtl"] .button-generate .icon, html[dir="rtl"] .copy-button .icon {
            margin-right: 0;
            margin-left: 0.5em;
        }

        /* Learn & Grow specific styles (LinkedIn-inspired) */
        .article-card {
            background-color: #ffffff;
            border-radius: 0.5rem;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
            padding: 1.25rem;
            border: 1px solid var(--linkedin-gray-100);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .article-icon {
            font-size: 2rem;
            margin-bottom: 0.75rem;
            text-align: center;
        }

        .article-title {
            font-size: 1.15rem;
            font-weight: 600;
            color: var(--linkedin-blue-dark);
            margin-bottom: 0.5rem;
        }

        .article-description {
            font-size: 0.9rem;
            color: var(--linkedin-text-medium);
            line-height: 1.4;
            flex-grow: 1; /* Allows description to take available space */
            margin-bottom: 1rem;
        }

        .article-link {
            display: inline-block;
            color: var(--linkedin-blue-primary);
            font-weight: 600;
            font-size: 0.9rem;
            text-decoration: none;
            transition: color 0.2s ease-in-out;
            align-self: flex-start; /* Align link to the start */
        }

        .article-link:hover {
            color: var(--linkedin-blue-dark);
            text-decoration: underline;
        }

        .articles-grid {
            /* Tailwind grid classes already provide responsive behavior */
            gap: 1rem; /* Space between cards */
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .app-main-container {
                padding: 1rem;
            }
            .app-header h1 {
                font-size: 1.5rem;
            }
            .app-header h2 {
                font-size: 1.2rem;
            }
            #sudani-logo {
                height: 35px;
            }
            .nav-bar {
                flex-direction: column;
                align-items: stretch; /* Stretch to fill width */
            }
            .nav-list {
                flex-direction: column; /* Stack nav items vertically */
                align-items: stretch;
            }
            .nav-list li {
                width: 100%; /* Full width for stacked nav buttons */
            }
            .nav-button {
                width: 100%; /* Ensure full width */
                text-align: center;
                padding: 0.75rem 1rem;
            }
            .language-switcher {
                margin-top: 1rem;
                justify-content: center; /* Center language buttons */
                width: 100%;
            }
            .module-section {
                padding: 1.5rem;
            }
            .input-group label {
                font-size: 0.9rem;
            }
            .input-group input, .input-group textarea, .input-group select {
                font-size: 0.95rem;
            }
            .button-generate {
                font-size: 0.95rem;
            }
            .output-area {
                padding: 1.5rem;
            }
            .output-area h3 {
                font-size: 1.1rem;
            }
            .output-item {
                padding: 1rem;
            }
        }
    </style>
</head>
<body class="p-4">
    <div class="app-main-container">
        <header class="app-header">
            <h2 data-i18n="employeePerformanceHub">Employee Performance Hub</h2>
            <!-- To make the logo portable, replace the src attribute with a Base64 encoded image string. -->
            <!-- You can use online tools to convert your 'Sudani_logo.png' to a Base64 string. -->
            <!-- Example: <img id="sudani-logo" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==" alt="Sudani Logo"> -->
            <img id="sudani-logo" src="https://placehold.co/100x45/004182/FFFFFF?text=Logo" alt="Sudani Logo">
            <h1 data-i18n="appSubTitle">Employee Performance Drafting Tool</h1>
        </header>

        <nav class="nav-bar">
            <ul class="nav-list">
                <li><button id="nav-smartGoal" class="nav-button" data-i18n="smartGoalsBtn">SMART Goals</button></li>
                <li><button id="nav-performanceAppraisal" class="nav-button" data-i18n="appraisalFeedbackBtn">Appraisal Feedback</button></li>
                <li><button id="nav-performanceNote" class="nav-button" data-i18n="performanceNotesBtn">Performance Notes</button></li>
                <li><button id="nav-idp" class="nav-button" data-i18n="idpBtn">Individual Development Plan</button></li>
                <li><button id="nav-regularCheckIn" class="nav-button" data-i18n="regularCheckInBtn">Periodic Feedback (Regular Check-in)</button></li>
                <li><button id="nav-references" class="nav-button" data-i18n="learnGrowBtn">Learn & Grow</button></li>
            </ul>
            <div class="language-switcher">
                <button id="lang-en" class="lang-button active">EN</button>
                <button id="lang-ar" class="lang-button">AR</button>
            </div>
        </nav>

        <main id="app-content">
            <!-- Content for each module will be loaded here dynamically -->
        </main>
    </div>

    <script>
        // Icon SVGs (cleaned up and aligned with LinkedIn's style - simple line icons)
        const copyIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>`;
        const checkIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M20 6 9 17l-5-5"></path></svg>`;
        const loaderIcon = `<svg class="animate-spin" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>`;

        // Translation Dictionary
        const translations = {
            en: {
                employeePerformanceHub: 'Employee Performance Hub',
                appTitle: 'Performance Drafting Assistant',
                appSubTitle: 'Employee Performance Drafting Tool',
                smartGoalsBtn: 'SMART Goals',
                appraisalFeedbackBtn: 'Appraisal Feedback',
                performanceNotesBtn: 'Performance Notes',
                idpBtn: 'Individual Development Plan',
                regularCheckInBtn: 'Periodic Feedback (Regular Check-in)',
                learnGrowBtn: 'Learn & Grow',
                smartGoalDrafting: 'SMART Goal Drafting',
                goalName: 'Goal Name',
                targetKpi: 'Target/KPI',
                deadline: 'Deadline',
                successCriteriaInputLabel: 'Your Success Criteria (Optional)',
                generateSubtasks: 'Generate actionable subtasks',
                generateSmartGoal: 'Generate SMART Goal',
                generatedDrafts: 'Generated Drafts:',
                smartGoalDraft: 'Smart Goal Draft',
                goalLabel: 'Goal:',
                targetKpiLabel: 'Target/KPI:',
                suggestedSubtasks: 'Suggested Subtasks:',
                copyToClipboard: 'Copy to Clipboard',
                copied: 'Copied!',
                failedToCopy: 'Failed to copy text. Please copy manually.',
                fillAllMandatoryFields: 'Please fill in all mandatory fields: Goal Name, Target/KPI, and Deadline.',
                failedToGenerate: 'Failed to generate:',
                failedToGenerateGoals: 'Failed to generate SMART goals or received an empty response. Please try adjusting your inputs.',
                targetKpiNotAvailable: 'N/A',
                suggestSuccessCriteria: 'Suggest success criteria',
                suggestedSuccessCriteria: 'Suggested Success Criteria:',

                appraisalFeedback: 'Performance Appraisal Feedback',
                selectPerformanceTier: 'Select Performance Tier',
                poorPerformance: 'Poor Performance',
                belowExpectations: 'Below Expectations',
                meetExpectations: 'Meet Expectations',
                exceedExpectations: 'Exceed Expectations',
                outstanding: 'Outstanding',
                inputsFor: 'Inputs for',
                employeeDidntAchieveGoals: 'Confirmation that the employee didn’t achieve all goals',
                documentedExamples: 'Documented examples of behaviors or outcomes that led to this evaluation',
                managerSupportExamples: 'Examples of support provided by the manager to enhance performance',
                strengthsWeaknessesAnalysis: 'Strengths and weaknesses analysis',
                projectsGoalsUnmet: 'Projects/goals/initiatives where expectations were not met',
                documentedBehaviorResults: 'Documented behavior/result examples that didn’t meet expectations',
                managerSupportToImprove: 'Manager support examples to improve behavior',
                proposedTrainingPlan: 'Proposed individual training plan',
                skillsForFutureAdvancement: 'Skills and experiences required for future advancement',
                plannedResponsibilities: 'Planned Responsibilities',
                accomplishedResponsibilities: 'Accomplished Responsibilities',
                coreResponsibilities: 'Core Responsibilities',
                additionalAchievements: 'Additional achievements',
                justificationAdditional: 'Justification for “additional” classification',
                achievementsImpact: 'Impact of these achievements',
                outstandingSubOption: 'Outstanding Sub-option',
                selectAnOption: 'Select an option',
                workedInRiskAreas: 'Worked in risk area',
                createdInnovation: 'Created innovation',
                exceededTarget: 'Exceeded target',
                missionDetails: 'Mission Details (location, time, risk context)',
                solutionDescription: 'Solution description',
                businessImpactMetrics: 'Business impact metrics',
                targetSurpassMetrics: 'Target surpass metrics (quantitative)',
                impactExceededTarget: 'Impact',
                generateFeedback: 'Generate Feedback',
                generatedFeedback: 'Generated Feedback:',
                fillAppraisalMandatoryFields: 'Please select a performance tier and fill in all mandatory fields for the selected tier.',

                performanceNotes: 'Performance Notes',
                dateOfObservation: 'Date of Observation',
                feedbackType: 'Feedback Type',
                recognition: 'Recognition',
                development: 'Development',
                general: 'General',
                observedBehaviorAction: 'Observed Behavior/Action',
                contextSituation: 'Context/Situation',
                impactOutcome: 'Impact/Outcome',
                sentimentIndicator: 'Sentiment Indicator',
                positive: 'Positive',
                negative: 'Negative',
                neutral: 'Neutral',
                alignmentGoalsValues: 'Alignment with Goals/Values',
                nextSteps: 'Next Steps',
                generatePerformanceNote: 'Generate Performance Note',
                generatedNote: 'Generated Note:',
                fillNoteMandatoryFields: 'Please fill in all mandatory fields: Date of Observation, Feedback Type, Observed Behavior/Action, Context/Situation, Impact/Outcome, and Sentiment Indicator.',

                idp: 'Individual Development Plan',
                employeeCurrentRole: 'Employee\'s Current Role',
                currentSkillsStrengths: 'Current Skills and Strengths',
                desiredSkillsDevelopment: 'Desired Skills/Areas for Development',
                careerAspirations: 'Career Aspirations',

                developmentTarget: 'Development Target Skill/Competency/Goal',
                developmentActivities: 'Development Activities',
                addActivity: 'Add',
                trainingCourses: 'Training/Courses',
                workshopsCertifications: 'Workshops/Certifications',
                jobShadowingMentoring: 'Job Shadowing/Mentoring',
                stretchAssignments: 'Stretch Assignments',
                researchTopics: 'Research Topics',
                networking: 'Networking',
                supportResources: 'Support & Resources',
                managerOrgSupport: 'Manager/Org Support Required',
                budgetTimeEstimates: 'Budget/Time Estimates',
                toolsSystemsNeeded: 'Tools/Systems Needed',
                activityTypeLabel: 'Activity Type',
                detailedDescription: 'Detailed Description',

                regularCheckInFeedback: 'Periodic Feedback',
                dateOfCheckIn: 'Date of Check-in',
                progressOnGoals: 'Progress on Goals/Projects',
                challenges: 'Challenges/Roadblocks (Optional)',
                accomplishments: 'Accomplishments/Highlights (Optional)',
                managerObservations: 'Manager Observations/Feedback (Optional)',
                nextStepsCheckIn: 'Next Steps/Action Items (Optional)',
                generateCheckInFeedback: 'Generate Periodic Feedback',
                generatedCheckInFeedback: 'Generated Periodic Feedback:',
                fillCheckInMandatoryFields: 'Please fill in all mandatory fields for Periodic Feedback: Date and Progress on Goals.',


                generateIdp: 'Generate IDP',
                generatedIdpDraft: 'Generated IDP Draft:',
                fillIdpMandatoryFields: 'Please fill in all mandatory fields for the Individual Development Plan.',

                placeholderGoalName: 'e.g., Increase customer satisfaction',
                placeholderTargetKpi: 'e.g., NPS score by 10 points',
                placeholderDeadline: 'Select a date',
                placeholderSuccessCriteriaInput: 'e.g., Achieve 90% customer satisfaction score',
                placeholderEmployeeDidntAchieveGoals: 'Confirm whether the employee achieved all goals (Yes/No)',
                placeholderDocumentedExamples: 'Provide specific examples of behaviors or outcomes.',
                placeholderManagerSupportExamples: 'Describe support provided (e.g., coaching, training).',
                placeholderStrengthsWeaknessesAnalysis: 'Analyze key strengths and areas for development.',
                placeholderProjectsGoalsUnmet: 'List projects or goals where expectations were not met.',
                placeholderDocumentedBehaviorResults: 'Provide examples of behaviors or results that fell short.',
                placeholderManagerSupportToImprove: 'Examples of managerial support to improve performance.',
                placeholderProposedTrainingPlan: 'Outline a proposed individual training plan.',
                placeholderSkillsForFutureAdvancement: 'Identify skills, knowledge, and experiences needed for career growth.',
                placeholderPlannedResponsibilities: 'e.g., Responsible for Q1 sales report, managed customer database.',
                placeholderAccomplishedResponsibilities: 'e.g., Delivered Q1 sales report on time, successfully updated 95% of customer records.',
                placeholderCoreResponsibilities: 'Describe how core responsibilities were performed.',
                placeholderAdditionalAchievements: 'Detail achievements beyond core responsibilities.',
                placeholderJustificationAdditional: 'Explain why these additional achievements are significant.',
                placeholderAchievementsImpact: 'Describe the impact of these achievements.',
                placeholderMissionDetails: 'Provide details about the mission, location, time, and risk context.',
                placeholderSolutionDescription: 'Describe the innovative solution created.',
                placeholderBusinessImpactMetrics: 'Quantify the business impact of the innovation (e.g., cost savings, revenue increase).',
                placeholderTargetSurpassMetrics: 'Provide quantitative details on how targets were surpassed.',
                placeholderImpactExceededTarget: 'Describe the impact of exceeding the target.',
                placeholderObservedBehaviorAction: 'Describe the specific behavior or action observed.',
                placeholderContextSituation: 'Describe the situation or context in which the behavior/action occurred.',
                placeholderImpactOutcome: 'Describe the impact or outcome of the observed behavior/action.',
                placeholderSentimentIndicator: 'Select sentiment',
                placeholderAlignmentGoalsValues: 'Explain how the behavior aligns (or not) with company goals or values.',
                placeholderNextSteps: 'Outline any follow-up actions, discussions, or plans.',
                placeholderDevelopmentTarget: 'e.g., Project Management, Leadership Skills',
                placeholderActivityDescription: 'e.g., Complete "Project Management Professional" certification course',
                placeholderManagerOrgSupport: 'e.g., Manager to provide mentorship, Budget for external training',
                placeholderBudgetTimeEstimates: 'e.g., $1500, 40 hours over 3 months',
                placeholderToolsSystemsNeeded: 'e.g., Access to Jira, Salesforce',
                placeholderProgressOnGoals: 'e.g., Completed Phase 1 of Project X, met all deadlines.',
                placeholderChallenges: 'e.g., Faced technical issues with software Y, resolved by collaborating with Z team.',
                placeholderAccomplishments: 'e.g., Successfully launched feature A, received positive feedback from users.',
                placeholderManagerObservations: "e.g., Noted employee's proactive approach to problem-solving.",
                placeholderNextStepsCheckIn: 'e.g., Follow up on software Y updates, research new training opportunities.',
                learnGrowIntroContent: 'This section provides resources and references for effective performance management practices, helping you and your team to learn and grow:',
                performancePlanningSubcategory: 'Employee Performance Planning: Setting SMART Goals & Cascading Objectives',
                performancePlanningContent: 'This section provides resources for effective goal setting and performance planning, including techniques for SMART goal creation and cascading objectives within an organization:',
                reference1: '1. Harvard Business Review: "How to Give Performance Reviews" - [Link](https://hbr.org/2021/01/how-to-give-performance-reviews)',
                reference2: '2. Forbes: "The Importance Of Employee Performance Reviews" - [Link](https://www.forbes.com/sites/forbeshumanresourcescouncil/2023/07/28/the-importance-of-employee-performance-reviews/?sh=5f0f3e6a4b1f)',
                reference3: '3. SHRM: "Performance Management" - [Link](https://www.shrm.org/resourcesandtools/tools-and-samples/hr-qa/pages/whatisperformancemanagement.aspx)',
                // New translations for article cards
                reference1Title: 'How to Give Performance Reviews',
                reference1Description: 'A comprehensive guide from HBR on effective performance evaluations.',
                reference2Title: 'The Importance Of Employee Performance Reviews',
                reference2Description: 'Forbes discusses why regular performance reviews are crucial for employee growth and organizational success.',
                reference3Title: 'Performance Management (SHRM)',
                reference3Description: 'SHRM\'s overview on performance management, covering various aspects and best practices.',
                readMore: 'Read More'
            },
            ar: {
                employeePerformanceHub: 'مركز أداء الموظفين',
                appTitle: 'مساعد صياغة الأداء',
                appSubTitle: 'أداة صياغة أداء الموظفين',
                smartGoalsBtn: 'أهداف SMART',
                appraisalFeedbackBtn: 'ملاحظات التقييم',
                performanceNotesBtn: 'ملاحظات الأداء',
                idpBtn: 'خطة التطوير الفردي',
                regularCheckInBtn: 'ملاحظات دورية (مراجعة منتظمة)',
                learnGrowBtn: 'تعلم وتطور',
                smartGoalDrafting: 'صياغة هدف SMART',
                goalName: 'اسم الهدف',
                targetKpi: 'الهدف/مؤشر الأداء الرئيسي',
                deadline: 'الموعد النهائي',
                successCriteriaInputLabel: 'معايير النجاح الخاصة بك (اختياري)',
                generateSubtasks: 'توليد مهام فرعية قابلة للتنفيذ',
                generateSmartGoal: 'توليد هدف SMART',
                generatedDrafts: 'المسودات المتولدة:',
                smartGoalDraft: 'مسودة هدف ذكي',
                goalLabel: 'الهدف:',
                targetKpiLabel: 'الهدف/مؤشر الأداء الرئيسي:',
                suggestedSubtasks: 'المهام الفرعية المقترحة:',
                copyToClipboard: 'نسخ إلى الحافظة',
                copied: 'تم النسخ!',
                failedToCopy: 'فشل نسخ النص. يرجى النسخ يدويًا.',
                fillAllMandatoryFields: 'يرجى ملء جميع الحقول الإلزامية: اسم الهدف، الهدف/مؤشر الأداء الرئيسي، والموعد النهائي.',
                failedToGenerate: 'فشل التوليد:',
                failedToGenerateGoals: 'فشل في توليد أهداف SMART أو تم استلام استجابة فارغة. يرجى محاولة تعديل مدخلاتك.',
                targetKpiNotAvailable: 'غير متاح',
                suggestSuccessCriteria: 'اقتراح معايير النجاح',
                suggestedSuccessCriteria: 'معايير النجاح المقترحة:',

                appraisalFeedback: 'ملاحظات تقييم الأداء',
                selectPerformanceTier: 'اختر مستوى الأداء',
                poorPerformance: 'أداء ضعيف',
                belowExpectations: 'أقل من التوقعات',
                meetExpectations: 'يلبي التوقعات',
                exceedExpectations: 'يتجاوز التوقعات',
                outstanding: 'متميز',
                inputsFor: 'مدخلات لـ',
                employeeDidntAchieveGoals: 'تأكيد بأن الموظف لم يحقق جميع الأهداف',
                documentedExamples: 'أمثلة موثقة للسلوكيات أو النتائج التي أدت إلى هذا التقييم',
                managerSupportExamples: 'أمثلة على الدعم المقدم من المدير لتحسين الأداء',
                strengthsWeaknessesAnalysis: 'تحليل نقاط القوة والضعف',
                projectsGoalsUnmet: 'المشاريع/الأهداف/المبادرات التي لم يتم تحقيق التوقعات فيها',
                documentedBehaviorResults: 'أمثلة موثقة للسلوكيات/النتائج التي لم تحقق التوقعات',
                managerSupportToImprove: 'أمثلة على دعم المدير لتحسين السلوك',
                proposedTrainingPlan: 'خطة تدريب فردية مقترحة',
                skillsForFutureAdvancement: 'المهارات والخبرات المطلوبة للتقدم المستقبلي',
                plannedResponsibilities: 'المسؤوليات المخطط لها',
                accomplishedResponsibilities: 'المسؤوليات المنجزة',
                coreResponsibilities: 'المسؤوليات الأساسية',
                additionalAchievements: 'الإنجازات الإضافية',
                justificationAdditional: 'مبرر للتصنيف "إضافي"',
                achievementsImpact: 'تأثير هذه الإنجازات',
                outstandingSubOption: 'خيار فرعي لمتميز',
                selectAnOption: 'اختر خيارًا',
                workedInRiskAreas: 'عمل في منطقة خطر',
                createdInnovation: 'أوجد ابتكارًا',
                exceededTarget: 'تجاوز الهدف',
                missionDetails: 'تفاصيل المهمة (الموقع، الوقت، سياق المخاطر)',
                solutionDescription: 'وصف الحل',
                businessImpactMetrics: 'مقاييس الأثر التجاري',
                targetSurpassMetrics: 'مقاييس تجاوز الهدف (كمية)',
                impactExceededTarget: 'التأثير',
                generateFeedback: 'توليد ملاحظات',
                generatedFeedback: 'الملاحظات المتولدة:',
                fillAppraisalMandatoryFields: 'الرجاء تحديد مستوى الأداء وملء جميع الحقول الإلزامية للمستوى المحدد.',

                performanceNotes: 'ملاحظات الأداء',
                dateOfObservation: 'تاريخ الملاحظة',
                feedbackType: 'نوع الملاحظة',
                recognition: 'تقدير',
                development: 'تطوير',
                general: 'عام',
                observedBehaviorAction: 'السلوك/الإجراء الملاحظ',
                contextSituation: 'السياق/الوضع',
                impactOutcome: 'التأثير/النتيجة',
                sentimentIndicator: 'مؤشر الشعور',
                positive: 'إيجابي',
                negative: 'سلبي',
                neutral: 'محايد',
                alignmentGoalsValues: 'التوافق مع الأهداف/القيم',
                nextSteps: 'الخطوات التالية',
                generatePerformanceNote: 'توليد ملاحظة أداء',
                generatedNote: 'الملاحظة المتولدة:',
                fillNoteMandatoryFields: 'يرجى ملء جميع الحقول الإلزامية: تاريخ الملاحظة، نوع الملاحظة، السلوك/الإجراء الملاحظ، السياق/الوضع، التأثير/النتيجة، ومؤشر الشعور.',

                idp: 'خطة التطوير الفردي',
                employeeCurrentRole: 'الدور الحالي للموظف',
                currentSkillsStrengths: 'المهارات ونقاط القوة الحالية',
                desiredSkillsDevelopment: 'المهارات/المجالات المرغوبة للتطوير',
                careerAspirations: 'الطموحات المهنية',

                developmentTarget: 'المهارة/الكفاءة/الهدف المستهدف للتطوير',
                developmentActivities: 'أنشطة التطوير',
                addActivity: 'إضافة',
                trainingCourses: 'التدريب/الدورات',
                workshopsCertifications: 'ورش العمل/الشهادات',
                jobShadowingMentoring: 'التدريب العملي/التوجيه',
                stretchAssignments: 'المهام الصعبة',
                researchTopics: 'مواضيع البحث',
                networking: 'التواصل',
                supportResources: 'الدعم والموارد',
                managerOrgSupport: 'دعم المدير/المنظمة المطلوب',
                budgetTimeEstimates: 'تقديرات الميزانية/الوقت',
                toolsSystemsNeeded: 'الأدوات/الأنظمة المطلوبة',
                activityTypeLabel: 'نوع النشاط',
                detailedDescription: 'وصف تفصيلي',

                regularCheckInFeedback: 'ملاحظات دورية',
                dateOfCheckIn: 'تاريخ المراجعة',
                progressOnGoals: 'التقدم في الأهداف/المشاريع',
                challenges: 'التحديات/العوائق (اختياري)',
                accomplishments: 'الإنجازات/النقاط البارزة (اختياري)',
                managerObservations: 'ملاحظات المدير/الملاحظات (اختياري)',
                nextStepsCheckIn: 'الخطوات التالية/بنود الإجراءات (اختياري)',
                generateCheckInFeedback: 'توليد ملاحظات دورية',
                generatedCheckInFeedback: 'الملاحظات الدورية المتولدة:',
                fillCheckInMandatoryFields: 'يرجى ملء جميع الحقول الإلزامية للملاحظات الدورية: التاريخ والتقدم في الأهداف.',

                generateIdp: 'توليد خطة تطوير فردي',
                generatedIdpDraft: 'مسودة خطة تطوير فردي المتولدة:',
                fillIdpMandatoryFields: 'يرجى ملء جميع الحقول الإلزامية لخطة التطوير الفردي.',

                placeholderGoalName: 'مثال: زيادة رضا العملاء',
                placeholderTargetKpi: 'مثال: زيادة نقاط NPS بمقدار 10 نقاط',
                placeholderDeadline: 'اختر تاريخًا',
                placeholderSuccessCriteriaInput: 'مثال: تحقيق 90% في مؤشر رضا العملاء',
                placeholderEmployeeDidntAchieveGoals: 'تأكيد ما إذا كان الموظف قد حقق جميع الأهداف (نعم/لا)',
                placeholderDocumentedExamples: 'قدم أمثلة محددة للسلوكيات أو النتائج.',
                placeholderManagerSupportExamples: 'صف الدعم المقدم (مثل: التدريب، التوجيه).',
                placeholderStrengthsWeaknessesAnalysis: 'حلل نقاط القوة الرئيسية ومجالات التطوير.',
                placeholderProjectsGoalsUnmet: 'اذكر المشاريع أو الأهداف التي لم يتم تحقيق التوقعات فيها.',
                placeholderDocumentedBehaviorResults: 'قدم أمثلة على السلوكيات أو النتائج التي لم تحقق التوقعات.',
                placeholderManagerSupportToImprove: 'أمثلة على الدعم الإداري لتحسين الأداء.',
                placeholderProposedTrainingPlan: 'حدد خطة تدريب فردية مقترحة.',
                placeholderSkillsForFutureAdvancement: 'حدد المهارات والمعرفة والخبرات اللازمة للنمو الوظيفي.',
                placeholderPlannedResponsibilities: 'مثال: مسؤول عن تقرير مبيعات الربع الأول، إدارة قاعدة بيانات العملاء.',
                placeholderAccomplishedResponsibilities: 'مثال: تم تسليم تقرير مبيعات الربع الأول في الموعد المحدد، وتم تحديث 95% من سجلات العملاء بنجاح.',
                placeholderCoreResponsibilities: 'صف كيفية أداء المسؤوليات الأساسية.',
                placeholderAdditionalAchievements: 'اذكر بالتفصيل الإنجازات التي تتجاوز المسؤوليات الأساسية.',
                placeholderJustificationAdditional: 'اشرح لماذا تعتبر هذه الإنجازات الإضافية مهمة.',
                placeholderAchievementsImpact: 'صف تأثير هذه الإنجازات.',
                placeholderMissionDetails: 'قدم تفاصيل حول المهمة، الموقع، الوقت، وسياق المخاطر.',
                placeholderSolutionDescription: 'صف الحل المبتكر الذي تم إنشاؤه.',
                placeholderBusinessImpactMetrics: 'حدد كميًا التأثير التجاري للابتكار (مثل: توفير التكاليف، زيادة الإيرادات).',
                placeholderTargetSurpassMetrics: 'قدم تفاصيل كمية حول كيفية تجاوز الأهداف.',
                placeholderImpactExceededTarget: 'صف تأثير تجاوز الهدف.',
                placeholderObservedBehaviorAction: 'صف السلوك أو الإجراء المحدد الملاحظ.',
                placeholderContextSituation: 'صف الوضع أو السياق الذي حدث فيه السلوك/الإجراء.',
                placeholderImpactOutcome: 'صف التأثير أو النتيجة للسلوك/الإجراء الملاحظ.',
                placeholderSentimentIndicator: 'اختر الشعور',
                placeholderAlignmentGoalsValues: 'اشرح كيف يتوافق السلوك (أو لا يتوافق) مع أهداف أو قيم الشركة.',
                placeholderNextSteps: 'حدد أي إجراءات متابعة أو مناقشات أو خطط.',
                placeholderDevelopmentTarget: 'مثال: إدارة المشاريع، مهارات القيادة',
                placeholderActivityDescription: 'مثال: إكمال دورة شهادة "محترف إدارة المشاريع"',
                placeholderManagerOrgSupport: 'مثال: أن يقدم المدير التوجيه، ميزانية للتدريب الخارجي',
                placeholderBudgetTimeEstimates: 'مثال: 1500 دولار، 40 ساعة على مدى 3 أشهر',
                placeholderToolsSystemsNeeded: 'مثال: الوصول إلى Jira, Salesforce',
                placeholderProgressOnGoals: 'مثال: تم الانتهاء من المرحلة الأولى من المشروع X، وتم الوفاء بجميع المواعيد النهائية.',
                placeholderChallenges: 'مثال: واجهت مشاكل فنية مع البرنامج Y، وتم حلها بالتعاون مع فريق Z.',
                placeholderAccomplishments: 'مثال: تم إطلاق الميزة A بنجاح، وتلقينا ردود فعل إيجابية من المستخدمين.',
                placeholderManagerObservations: 'مثال: لاحظت نهج الموظف الاستباقي في حل المشكلات.',
                placeholderNextStepsCheckIn: 'مثال: متابعة تحديثات البرنامج Y، البحث عن فرص تدريب جديدة.',
                learnGrowIntroContent: 'يقدم هذا القسم مصادر ومراجع لممارسات إدارة الأداء الفعالة، مما يساعدك وفريقك على التعلم والنمو:',
                performancePlanningSubcategory: 'تخطيط أداء الموظفين: تحديد أهداف SMART والأهداف المتسلسلة',
                performancePlanningContent: 'يقدم هذا القسم مصادر لتحديد الأهداف الفعال وتخطيط الأداء، بما في ذلك تقنيات إنشاء أهداف SMART والأهداف المتسلسلة داخل المنظمة:',
                reference1: '1. Harvard Business Review: "How to Give Performance Reviews" - [رابط](https://hbr.org/2021/01/how-to-give-performance-reviews)',
                reference2: '2. Forbes: "The Importance Of Employee Performance Reviews" - [رابط](https://www.forbes.com/sites/forbeshumanresourcescouncil/2023/07/28/the-importance-of-employee-performance-reviews/?sh=5f0f3e6a4b1f)',
                reference3: '3. SHRM: "Performance Management" - [رابط](https://www.shrm.org/resourcesandtools/tools-and-samples/hr-qa/pages/whatisperformancemanagement.aspx)',
                // New translations for article cards
                reference1Title: 'كيفية تقديم تقييمات الأداء',
                reference1Description: 'دليل شامل من هارفارد بيزنس ريفيو حول تقييمات الأداء الفعالة.',
                reference2Title: 'أهمية تقييمات أداء الموظفين',
                reference2Description: 'تناقش فوربس سبب أهمية تقييمات الأداء المنتظمة لنمو الموظفين ونجاح المنظمة.',
                reference3Title: 'إدارة الأداء (SHRM)',
                reference3Description: 'نظرة عامة من SHRM على إدارة الأداء، تغطي جوانب وممارسات مختلفة.',
                readMore: 'اقرأ المزيد'
            }
        };

        let currentLanguage = localStorage.getItem('appLanguage') || 'en';
        let activeModuleRenderer = renderSmartGoalDrafting; // Keep track of the currently active module renderer

        /**
         * Calls the Gemini API with the given prompt and optional schema.
         * @param {string} prompt The text prompt to send to the Gemini API.
         * @param {object|null} schema Optional JSON schema for structured responses.
         * @returns {Promise<string|object>} The generated text or parsed JSON object.
         */
        async function callGeminiApi(prompt, schema = null) {
            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            const payload = { contents: chatHistory };

            // For structured output, add generationConfig
            if (schema) {
                payload.generationConfig = {
                    responseMimeType: "application/json",
                    responseSchema: schema
                };
            }

            const apiKey = ""; // If you want to use models other than gemini-2.0-flash or imagen-3.0-generate-002, provide an API key here. Otherwise, leave this as-is.
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    if (schema) {
                        try {
                            return JSON.parse(text);
                        } catch (e) {
                            console.error("Failed to parse JSON response:", e);
                            return null;
                        }
                    } else {
                        return text;
                    }
                } else {
                    console.error("Unexpected API response structure:", result);
                    return null;
                }
            } catch (error) {
                console.error("Error calling Gemini API:", error);
                return null;
            }
        }


        /**
         * Applies translations to all elements with a `data-i18n` attribute.
         */
        function applyTranslations() {
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[currentLanguage] && translations[currentLanguage][key]) {
                    element.textContent = translations[currentLanguage][key];
                }
            });
            // Update placeholders dynamically as well
            const placeholders = {
                'goalNameInput': 'placeholderGoalName',
                'targetKpiInput': 'placeholderTargetKpi',
                'deadlineInput': 'placeholderDeadline',
                'successCriteriaInput': 'placeholderSuccessCriteriaInput',
                'employeeDidntAchieveGoals': 'placeholderEmployeeDidntAchieveGoals',
                'documentedExamples': 'placeholderDocumentedExamples',
                'managerSupportExamples': 'placeholderManagerSupportExamples',
                'strengthsWeaknessesAnalysis': 'placeholderStrengthsWeaknessesAnalysis',
                'projectsGoalsUnmet': 'placeholderProjectsGoalsUnmet',
                'documentedBehaviorResults': 'placeholderDocumentedBehaviorResults',
                'managerSupportToImprove': 'placeholderManagerSupportToImprove',
                'proposedTrainingPlan': 'placeholderProposedTrainingPlan',
                'skillsForFutureAdvancement': 'placeholderSkillsForFutureAdvancement',
                'plannedResponsibilities': 'placeholderPlannedResponsibilities',
                'accomplishedResponsibilities': 'placeholderAccomplishedResponsibilities',
                'coreResponsibilities': 'placeholderCoreResponsibilities',
                'additionalAchievements': 'placeholderAdditionalAchievements',
                'justificationAdditional': 'placeholderJustificationAdditional',
                'achievementsImpact': 'placeholderAchievementsImpact',
                'missionDetails': 'placeholderMissionDetails',
                'solutionDescription': 'placeholderSolutionDescription',
                'businessImpactMetrics': 'placeholderBusinessImpactMetrics',
                'targetSurpassMetrics': 'placeholderTargetSurpassMetrics',
                'impactExceededTarget': 'placeholderImpactExceededTarget',
                'observedBehaviorAction': 'placeholderObservedBehaviorAction',
                'contextSituation': 'placeholderContextSituation',
                'impactOutcome': 'placeholderImpactOutcome',
                'alignmentGoalsValues': 'placeholderAlignmentGoalsValues',
                'nextSteps': 'placeholderNextSteps',
                'developmentTarget': 'placeholderDevelopmentTarget',
                'activityDescription': 'placeholderActivityDescription',
                'managerOrgSupport': 'placeholderManagerOrgSupport',
                'budgetTimeEstimates': 'placeholderBudgetTimeEstimates',
                'toolsSystemsNeeded': 'placeholderToolsSystemsNeeded',
                'progressOnGoals': 'placeholderProgressOnGoals',
                'challenges': 'placeholderChallenges',
                'accomplishments': 'placeholderAccomplishments',
                'managerObservations': 'placeholderManagerObservations',
                'nextStepsCheckIn': 'placeholderNextStepsCheckIn',
                'sentimentIndicator': 'placeholderSentimentIndicator' // For select elements
            };

            for (const id in placeholders) {
                const element = document.getElementById(id);
                if (element && translations[currentLanguage] && translations[currentLanguage][placeholders[id]]) {
                    if (element.tagName === 'SELECT') {
                         // Update options for select elements
                        Array.from(element.options).forEach(option => {
                            const optionKey = option.getAttribute('data-i18n');
                            if (optionKey && translations[currentLanguage] && translations[currentLanguage][optionKey]) {
                                option.textContent = translations[currentLanguage][optionKey];
                            }
                        });
                        // Update the default selected option text if it's dynamic
                        if (element.value === "" && translations[currentLanguage] && translations[currentLanguage][placeholders[id]]) {
                            element.querySelector('option[value=""]').textContent = translations[currentLanguage][placeholders[id]];
                        }
                    } else {
                        element.placeholder = translations[currentLanguage][placeholders[id]];
                    }
                }
            }
        }


        /**
         * Sets the application language and updates the UI.
         * @param {string} lang The language code ('en' or 'ar').
         */
        function setLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('appLanguage', lang);
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            applyTranslations();
            updateActiveLangButton();
            // Re-render the active module to apply language-specific content
            if (activeModuleRenderer) {
                activeModuleRenderer();
            }
        }

        /**
         * Updates the active state of language buttons.
         */
        function updateActiveLangButton() {
            document.querySelectorAll('.lang-button').forEach(button => {
                button.classList.remove('active');
                if (button.id === `lang-${currentLanguage}`) {
                    button.classList.add('active');
                }
            });
        }

        /**
         * Displays a temporary message (success or error).
         * @param {string} message The message to display.
         * @param {string} type The type of message ('success' or 'error').
         * @param {HTMLElement} container The element to append the message to.
         */
        function displayMessage(message, type, container) {
            const messageElement = document.createElement('div');
            messageElement.textContent = message;
            messageElement.className = `error-message ${type === 'success' ? 'bg-linkedin-green' : 'bg-linkedin-red'} text-white p-3 rounded-md mb-4 text-center`;
            container.prepend(messageElement);
            setTimeout(() => {
                messageElement.remove();
            }, 5000);
        }

        /**
         * Copies text to the clipboard.
         * @param {string} text The text to copy.
         * @param {HTMLElement} buttonElement The button element that triggered the copy.
         */
        function copyTextToClipboard(text, buttonElement) {
            const originalText = buttonElement.innerHTML;
            const outputContainer = buttonElement.closest('.output-item') || document.getElementById('app-content'); // Fallback

            // Use execCommand for broader compatibility within iframes
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed'; // Avoid scrolling to bottom
            textarea.style.left = '-9999px'; // Hide off-screen
            document.body.appendChild(textarea);
            textarea.select();

            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    buttonElement.innerHTML = `${checkIcon} ${translations[currentLanguage].copied}`;
                    displayMessage(translations[currentLanguage].copied, 'success', outputContainer);
                } else {
                    throw new Error('Fallback copy failed');
                }
            } catch (err) {
                console.error('Fallback: Oops, unable to copy', err);
                displayMessage(translations[currentLanguage].failedToCopy, 'error', outputContainer);
            } finally {
                document.body.removeChild(textarea);
                setTimeout(() => {
                    buttonElement.innerHTML = originalText;
                }, 2000);
            }
        }

        /**
         * Renders the SMART Goal Drafting module.
         */
        function renderSmartGoalDrafting() {
            const appContent = document.getElementById('app-content');
            appContent.innerHTML = `
                <section class="module-section">
                    <h3 class="text-2xl font-bold mb-6 text-center text-linkedin-blue-dark" data-i18n="smartGoalDrafting">SMART Goal Drafting</h3>
                    <div class="input-group">
                        <label for="goalNameInput" data-i18n="goalName">Goal Name</label>
                        <input type="text" id="goalNameInput" class="rounded-md" placeholder="${translations[currentLanguage].placeholderGoalName}">
                    </div>
                    <div class="input-group">
                        <label for="targetKpiInput" data-i18n="targetKpi">Target/KPI</label>
                        <input type="text" id="targetKpiInput" class="rounded-md" placeholder="${translations[currentLanguage].placeholderTargetKpi}">
                    </div>
                    <div class="input-group">
                        <label for="deadlineInput" data-i18n="deadline">Deadline</label>
                        <input type="date" id="deadlineInput" class="rounded-md" placeholder="${translations[currentLanguage].placeholderDeadline}">
                    </div>
                    <div class="input-group">
                        <label for="successCriteriaInput" data-i18n="successCriteriaInputLabel">Your Success Criteria (Optional)</label>
                        <textarea id="successCriteriaInput" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderSuccessCriteriaInput}"></textarea>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="generateSubtasksCheckbox">
                        <label for="generateSubtasksCheckbox" data-i18n="generateSubtasks">Generate actionable subtasks</label>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="suggestSuccessCriteriaCheckbox">
                        <label for="suggestSuccessCriteriaCheckbox" data-i18n="suggestSuccessCriteria">Suggest success criteria</label>
                    </div>
                    <button id="generateSmartGoalBtn" class="button-generate">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><path d="M14 2v6h6"></path><path d="M12 18V12"></path><path d="M9 15h6"></path></svg>
                        <span data-i18n="generateSmartGoal">Generate SMART Goal</span>
                    </button>
                    <div id="smartGoalOutput" class="output-area hidden">
                        <h3 class="mb-4" data-i18n="generatedDrafts">Generated Drafts:</h3>
                    </div>
                </section>
            `;
            applyTranslations(); // Apply translations after rendering static HTML

            const generateButton = document.getElementById('generateSmartGoalBtn');
            const smartGoalOutput = document.getElementById('smartGoalOutput');
            const goalNameInput = document.getElementById('goalNameInput');
            const targetKpiInput = document.getElementById('targetKpiInput');
            const deadlineInput = document.getElementById('deadlineInput');
            const successCriteriaInput = document.getElementById('successCriteriaInput');
            const generateSubtasksCheckbox = document.getElementById('generateSubtasksCheckbox');
            const suggestSuccessCriteriaCheckbox = document.getElementById('suggestSuccessCriteriaCheckbox');
            const moduleSection = appContent.querySelector('.module-section');


            generateButton.onclick = async () => {
                const goalName = goalNameInput.value.trim();
                const targetKpi = targetKpiInput.value.trim();
                const deadline = deadlineInput.value.trim();
                const userSuccessCriteria = successCriteriaInput.value.trim();
                const shouldGenerateSubtasks = generateSubtasksCheckbox.checked;
                const shouldSuggestSuccessCriteria = suggestSuccessCriteriaCheckbox.checked;

                if (!goalName || !targetKpi || !deadline) {
                    displayMessage(translations[currentLanguage].fillAllMandatoryFields, 'error', moduleSection);
                    return;
                }

                generateButton.disabled = true;
                generateButton.innerHTML = `${loaderIcon} ${translations[currentLanguage].generateSmartGoal}`;
                smartGoalOutput.classList.add('hidden'); // Hide previous output

                let prompt = `As an HR assistant, draft a SMART goal based on the following details, considering the user's language preference (${currentLanguage}):\n\n`;
                prompt += `Goal Name: ${goalName}\n`;
                prompt += `Target/KPI: ${targetKpi}\n`;
                prompt += `Deadline: ${deadline}\n`;

                if (userSuccessCriteria) {
                    prompt += `User-provided Success Criteria: ${userSuccessCriteria}\n`;
                }

                prompt += `Ensure the goal is Specific, Measurable, Achievable, Relevant, and Time-bound.\n`;

                const schema = {
                    type: "OBJECT",
                    properties: {
                        smartGoal: { "type": "STRING" },
                        subtasks: {
                            type: "ARRAY",
                            items: { "type": "STRING" }
                        },
                        suggestedSuccessCriteria: {
                            type: "ARRAY",
                            items: { "type": "STRING" }
                        }
                    },
                    propertyOrdering: ["smartGoal", "subtasks", "suggestedSuccessCriteria"]
                };

                let generatedContent;
                try {
                    generatedContent = await callGeminiApi(prompt, schema);
                } catch (error) {
                    console.error("Error during API call for SMART Goal:", error);
                    displayMessage(`${translations[currentLanguage].failedToGenerate} ${error.message}`, 'error', moduleSection);
                    generateButton.disabled = false;
                    generateButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><path d="M14 2v6h6"></path><path d="M12 18V12"></path><path d="M9 15h6"></path></svg><span data-i18n="generateSmartGoal">${translations[currentLanguage].generateSmartGoal}</span>`;
                    return;
                }

                generateButton.disabled = false;
                generateButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><path d="M14 2v6h6"></path><path d="M12 18V12"></path><path d="M9 15h6"></path></svg><span data-i18n="generateSmartGoal">${translations[currentLanguage].generateSmartGoal}</span>`;


                if (generatedContent && generatedContent.smartGoal) {
                    smartGoalOutput.innerHTML = `<h3 class="mb-4" data-i18n="generatedDrafts">Generated Drafts:</h3>`;

                    // SMART Goal Draft
                    const goalItem = document.createElement('div');
                    goalItem.className = 'output-item';
                    goalItem.innerHTML = `
                        <h4 data-i18n="smartGoalDraft">Smart Goal Draft</h4>
                        <p><strong data-i18n="goalLabel">Goal:</strong> ${generatedContent.smartGoal}</p>
                        <p><strong data-i18n="targetKpiLabel">Target/KPI:</strong> ${targetKpi || translations[currentLanguage].targetKpiNotAvailable}</p>
                        <p><strong>${translations[currentLanguage].deadline}:</strong> ${deadline}</p>
                        <button class="copy-button">${copyIcon} <span data-i18n="copyToClipboard">${translations[currentLanguage].copyToClipboard}</span></button>
                    `;
                    goalItem.querySelector('.copy-button').onclick = (e) => {
                        e.preventDefault();
                        const textToCopy = `Goal: ${generatedContent.smartGoal}\nTarget/KPI: ${targetKpi || translations[currentLanguage].targetKpiNotAvailable}\nDeadline: ${deadline}`;
                        copyTextToClipboard(textToCopy, e.currentTarget);
                    };
                    smartGoalOutput.appendChild(goalItem);

                    // Suggested Subtasks
                    if (shouldGenerateSubtasks && generatedContent.subtasks && generatedContent.subtasks.length > 0) {
                        const subtasksItem = document.createElement('div');
                        subtasksItem.className = 'output-item';
                        const subtasksList = generatedContent.subtasks.map(task => `<li>${task}</li>`).join('');
                        subtasksItem.innerHTML = `
                            <h4 data-i18n="suggestedSubtasks">Suggested Subtasks:</h4>
                            <ul class="list-disc pl-5">
                                ${subtasksList}
                            </ul>
                            <button class="copy-button">${copyIcon} <span data-i18n="copyToClipboard">${translations[currentLanguage].copyToClipboard}</span></button>
                        `;
                        subtasksItem.querySelector('.copy-button').onclick = (e) => {
                            e.preventDefault();
                            const textToCopy = generatedContent.subtasks.map((task, index) => `${index + 1}. ${task}`).join('\n');
                            copyTextToClipboard(textToCopy, e.currentTarget);
                        };
                        smartGoalOutput.appendChild(subtasksItem);
                    }

                    // Suggested Success Criteria
                    if (shouldSuggestSuccessCriteria && generatedContent.suggestedSuccessCriteria && generatedContent.suggestedSuccessCriteria.length > 0) {
                        const successCriteriaItem = document.createElement('div');
                        successCriteriaItem.className = 'output-item';
                        const criteriaList = generatedContent.suggestedSuccessCriteria.map(criteria => `<li>${criteria}</li>`).join('');
                        successCriteriaItem.innerHTML = `
                            <h4 data-i18n="suggestedSuccessCriteria">Suggested Success Criteria:</h4>
                            <ul class="list-disc pl-5">
                                ${criteriaList}
                            </ul>
                            <button class="copy-button">${copyIcon} <span data-i18n="copyToClipboard">${translations[currentLanguage].copyToClipboard}</span></button>
                        `;
                        successCriteriaItem.querySelector('.copy-button').onclick = (e) => {
                            e.preventDefault();
                            const textToCopy = generatedContent.suggestedSuccessCriteria.map((criteria, index) => `${index + 1}. ${criteria}`).join('\n');
                            copyTextToClipboard(textToCopy, e.currentTarget);
                        };
                        smartGoalOutput.appendChild(successCriteriaItem);
                    }

                    smartGoalOutput.classList.remove('hidden');
                    applyTranslations(); // Apply translations to newly added elements
                } else {
                    displayMessage(translations[currentLanguage].failedToGenerateGoals, 'error', moduleSection);
                }
            };
        }


        /**
         * Renders the Performance Appraisal Feedback module.
         */
        function renderPerformanceAppraisal() {
            const appContent = document.getElementById('app-content');
            appContent.innerHTML = `
                <section class="module-section">
                    <h3 class="text-2xl font-bold mb-6 text-center text-linkedin-blue-dark" data-i18n="appraisalFeedback">Performance Appraisal Feedback</h3>
                    <div class="input-group">
                        <label for="performanceTier" data-i18n="selectPerformanceTier">Select Performance Tier</label>
                        <select id="performanceTier" class="rounded-md">
                            <option value="" data-i18n="selectAnOption">${translations[currentLanguage].selectAnOption}</option>
                            <option value="poorPerformance" data-i18n="poorPerformance">${translations[currentLanguage].poorPerformance}</option>
                            <option value="belowExpectations" data-i18n="belowExpectations">${translations[currentLanguage].belowExpectations}</option>
                            <option value="meetExpectations" data-i18n="meetExpectations">${translations[currentLanguage].meetExpectations}</option>
                            <option value="exceedExpectations" data-i18n="exceedExpectations">${translations[currentLanguage].exceedExpectations}</option>
                            <option value="outstanding" data-i18n="outstanding">${translations[currentLanguage].outstanding}</option>
                        </select>
                    </div>

                    <div id="tierSpecificInputs">
                        <!-- Inputs will be dynamically loaded here based on selection -->
                    </div>

                    <button id="generateAppraisalBtn" class="button-generate">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><path d="M14 2v6h6"></path><path d="M12 18V12"></path><path d="M9 15h6"></path></svg>
                        <span data-i18n="generateFeedback">Generate Feedback</span>
                    </button>
                    <div id="appraisalOutput" class="output-area hidden">
                        <h3 class="mb-4" data-i18n="generatedFeedback">Generated Feedback:</h3>
                    </div>
                </section>
            `;
            applyTranslations();

            const performanceTierSelect = document.getElementById('performanceTier');
            const tierSpecificInputs = document.getElementById('tierSpecificInputs');
            const generateAppraisalBtn = document.getElementById('generateAppraisalBtn');
            const appraisalOutput = document.getElementById('appraisalOutput');
            const moduleSection = appContent.querySelector('.module-section');


            /**
             * Renders input fields specific to the selected performance tier.
             * @param {string} tier The selected performance tier.
             */
            function renderTierInputs(tier) {
                tierSpecificInputs.innerHTML = '';
                let inputsHtml = '';

                switch (tier) {
                    case 'poorPerformance':
                        inputsHtml = `
                            <h4 class="text-xl font-semibold mb-4 text-linkedin-blue-dark" data-i18n="inputsFor">${translations[currentLanguage].inputsFor} ${translations[currentLanguage].poorPerformance}</h4>
                            <div class="input-group">
                                <label for="employeeDidntAchieveGoals" data-i18n="employeeDidntAchieveGoals">Confirmation that the employee didn’t achieve all goals</label>
                                <textarea id="employeeDidntAchieveGoals" rows="2" class="rounded-md" placeholder="${translations[currentLanguage].placeholderEmployeeDidntAchieveGoals}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="documentedExamples" data-i18n="documentedExamples">Documented examples of behaviors or outcomes that led to this evaluation</label>
                                <textarea id="documentedExamples" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderDocumentedExamples}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="managerSupportExamples" data-i18n="managerSupportExamples">Examples of support provided by the manager to enhance performance</label>
                                <textarea id="managerSupportExamples" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderManagerSupportExamples}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="strengthsWeaknessesAnalysis" data-i18n="strengthsWeaknessesAnalysis">Strengths and weaknesses analysis</label>
                                <textarea id="strengthsWeaknessesAnalysis" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderStrengthsWeaknessesAnalysis}"></textarea>
                            </div>
                        `;
                        break;
                    case 'belowExpectations':
                        inputsHtml = `
                            <h4 class="text-xl font-semibold mb-4 text-linkedin-blue-dark" data-i18n="inputsFor">${translations[currentLanguage].inputsFor} ${translations[currentLanguage].belowExpectations}</h4>
                            <div class="input-group">
                                <label for="projectsGoalsUnmet" data-i18n="projectsGoalsUnmet">Projects/goals/initiatives where expectations were not met</label>
                                <textarea id="projectsGoalsUnmet" rows="2" class="rounded-md" placeholder="${translations[currentLanguage].placeholderProjectsGoalsUnmet}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="documentedBehaviorResults" data-i18n="documentedBehaviorResults">Documented behavior/result examples that didn’t meet expectations</label>
                                <textarea id="documentedBehaviorResults" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderDocumentedBehaviorResults}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="managerSupportToImprove" data-i18n="managerSupportToImprove">Manager support examples to improve behavior</label>
                                <textarea id="managerSupportToImprove" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderManagerSupportToImprove}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="proposedTrainingPlan" data-i18n="proposedTrainingPlan">Proposed individual training plan</label>
                                <textarea id="proposedTrainingPlan" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderProposedTrainingPlan}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="skillsForFutureAdvancement" data-i18n="skillsForFutureAdvancement">Skills and experiences required for future advancement</label>
                                <textarea id="skillsForFutureAdvancement" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderSkillsForFutureAdvancement}"></textarea>
                            </div>
                        `;
                        break;
                    case 'meetExpectations':
                        inputsHtml = `
                            <h4 class="text-xl font-semibold mb-4 text-linkedin-blue-dark" data-i18n="inputsFor">${translations[currentLanguage].inputsFor} ${translations[currentLanguage].meetExpectations}</h4>
                            <div class="input-group">
                                <label for="accomplishedResponsibilities" data-i18n="accomplishedResponsibilities">Accomplished Responsibilities</label>
                                <textarea id="accomplishedResponsibilities" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderAccomplishedResponsibilities}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="coreResponsibilities" data-i18n="coreResponsibilities">Core responsibilities</label>
                                <textarea id="coreResponsibilities" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderCoreResponsibilities}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="additionalAchievements" data-i18n="additionalAchievements">Additional achievements (Optional)</label>
                                <textarea id="additionalAchievements" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderAdditionalAchievements}"></textarea>
                            </div>
                            <div class="input-group" id="justificationGroup" style="display:none;">
                                <label for="justificationAdditional" data-i18n="justificationAdditional">Justification for “additional” classification</label>
                                <textarea id="justificationAdditional" rows="2" class="rounded-md" placeholder="${translations[currentLanguage].placeholderJustificationAdditional}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="achievementsImpact" data-i18n="achievementsImpact">Impact of these achievements</label>
                                <textarea id="achievementsImpact" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderAchievementsImpact}"></textarea>
                            </div>
                        `;
                        break;
                    case 'exceedExpectations':
                        inputsHtml = `
                            <h4 class="text-xl font-semibold mb-4 text-linkedin-blue-dark" data-i18n="inputsFor">${translations[currentLanguage].inputsFor} ${translations[currentLanguage].exceedExpectations}</h4>
                            <div class="input-group">
                                <label for="accomplishedResponsibilities" data-i18n="accomplishedResponsibilities">Accomplished Responsibilities</label>
                                <textarea id="accomplishedResponsibilities" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderAccomplishedResponsibilities}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="additionalAchievements" data-i18n="additionalAchievements">Additional achievements</label>
                                <textarea id="additionalAchievements" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderAdditionalAchievements}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="justificationAdditional" data-i18n="justificationAdditional">Justification for “additional” classification</label>
                                <textarea id="justificationAdditional" rows="2" class="rounded-md" placeholder="${translations[currentLanguage].placeholderJustificationAdditional}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="achievementsImpact" data-i18n="achievementsImpact">Impact of these achievements</label>
                                <textarea id="achievementsImpact" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderAchievementsImpact}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="skillsForFutureAdvancement" data-i18n="skillsForFutureAdvancement">Skills and experiences required for future advancement</label>
                                <textarea id="skillsForFutureAdvancement" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderSkillsForFutureAdvancement}"></textarea>
                            </div>
                        `;
                        break;
                    case 'outstanding':
                        inputsHtml = `
                            <h4 class="text-xl font-semibold mb-4 text-linkedin-blue-dark" data-i18n="inputsFor">${translations[currentLanguage].inputsFor} ${translations[currentLanguage].outstanding}</h4>
                            <div class="input-group">
                                <label for="outstandingSubOption" data-i18n="outstandingSubOption">Outstanding Sub-option</label>
                                <select id="outstandingSubOption" class="rounded-md">
                                    <option value="" data-i18n="selectAnOption">${translations[currentLanguage].selectAnOption}</option>
                                    <option value="workedInRiskAreas" data-i18n="workedInRiskAreas">${translations[currentLanguage].workedInRiskAreas}</option>
                                    <option value="createdInnovation" data-i18n="createdInnovation">${translations[currentLanguage].createdInnovation}</option>
                                    <option value="exceededTarget" data-i18n="exceededTarget">${translations[currentLanguage].exceededTarget}</option>
                                </select>
                            </div>
                            <div id="outstandingSpecificInputs">
                                <!-- Sub-options inputs will be loaded here -->
                            </div>
                            <div class="input-group">
                                <label for="skillsForFutureAdvancement" data-i18n="skillsForFutureAdvancement">Skills and experiences required for future advancement</label>
                                <textarea id="skillsForFutureAdvancement" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderSkillsForFutureAdvancement}"></textarea>
                            </div>
                        `;
                        break;
                    default:
                        break;
                }
                tierSpecificInputs.innerHTML = inputsHtml;
                applyTranslations(); // Apply translations to newly rendered inputs

                if (tier === 'meetExpectations') {
                    const additionalAchievementsInput = document.getElementById('additionalAchievements');
                    const justificationGroup = document.getElementById('justificationGroup');
                    if (additionalAchievementsInput) {
                        additionalAchievementsInput.oninput = () => {
                            if (additionalAchievementsInput.value.trim() !== '') {
                                justificationGroup.style.display = 'block';
                            } else {
                                justificationGroup.style.display = 'none';
                            }
                        };
                        // Initial check in case there's pre-filled content (e.g., from a back action)
                        if (additionalAchievementsInput.value.trim() !== '') {
                            justificationGroup.style.display = 'block';
                        }
                    }
                }

                if (tier === 'outstanding') {
                    const outstandingSubOptionSelect = document.getElementById('outstandingSubOption');
                    const outstandingSpecificInputs = document.getElementById('outstandingSpecificInputs');
                    outstandingSubOptionSelect.onchange = () => {
                        renderOutstandingSubInputs(outstandingSubOptionSelect.value);
                    };
                    // Initial render for outstanding sub-options if a value is pre-selected
                    renderOutstandingSubInputs(outstandingSubOptionSelect.value);
                }
            }

            /**
             * Renders input fields specific to the selected outstanding sub-option.
             * @param {string} subOption The selected outstanding sub-option.
             */
            function renderOutstandingSubInputs(subOption) {
                const outstandingSpecificInputs = document.getElementById('outstandingSpecificInputs');
                outstandingSpecificInputs.innerHTML = '';
                let subInputsHtml = '';
                switch (subOption) {
                    case 'workedInRiskAreas':
                        subInputsHtml = `
                            <div class="input-group">
                                <label for="missionDetails" data-i18n="missionDetails">Mission Details (location, time, risk context)</label>
                                <textarea id="missionDetails" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderMissionDetails}"></textarea>
                            </div>
                        `;
                        break;
                    case 'createdInnovation':
                        subInputsHtml = `
                            <div class="input-group">
                                <label for="solutionDescription" data-i18n="solutionDescription">Solution description</label>
                                <textarea id="solutionDescription" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderSolutionDescription}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="businessImpactMetrics" data-i18n="businessImpactMetrics">Business impact metrics</label>
                                <textarea id="businessImpactMetrics" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderBusinessImpactMetrics}"></textarea>
                            </div>
                        `;
                        break;
                    case 'exceededTarget':
                        subInputsHtml = `
                            <div class="input-group">
                                <label for="targetSurpassMetrics" data-i18n="targetSurpassMetrics">Target surpass metrics (quantitative)</label>
                                <textarea id="targetSurpassMetrics" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderTargetSurpassMetrics}"></textarea>
                            </div>
                            <div class="input-group">
                                <label for="impactExceededTarget" data-i18n="impactExceededTarget">Impact</label>
                                <textarea id="impactExceededTarget" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderImpactExceededTarget}"></textarea>
                            </div>
                        `;
                        break;
                    default:
                        break;
                }
                outstandingSpecificInputs.innerHTML = subInputsHtml;
                applyTranslations(); // Apply translations to newly rendered sub-inputs
            }

            performanceTierSelect.onchange = () => {
                renderTierInputs(performanceTierSelect.value);
                appraisalOutput.classList.add('hidden'); // Hide output when tier changes
            };

            generateAppraisalBtn.onclick = async () => {
                const tier = performanceTierSelect.value;
                if (!tier) {
                    displayMessage(translations[currentLanguage].fillAppraisalMandatoryFields, 'error', moduleSection);
                    return;
                }

                let prompt = `As an HR assistant, draft a performance appraisal feedback for an employee based on the "${tier}" performance tier. Use the following details, formatted for ${currentLanguage}:\n\n`;
                let allFieldsFilled = true;
                const requiredFields = []; // Array to collect required field names

                // Collect data and check for mandatory fields based on the tier
                const data = {};
                switch (tier) {
                    case 'poorPerformance':
                        data.employeeDidntAchieveGoals = document.getElementById('employeeDidntAchieveGoals')?.value.trim();
                        data.documentedExamples = document.getElementById('documentedExamples')?.value.trim();
                        data.managerSupportExamples = document.getElementById('managerSupportExamples')?.value.trim();
                        data.strengthsWeaknessesAnalysis = document.getElementById('strengthsWeaknessesAnalysis')?.value.trim();
                        if (!data.employeeDidntAchieveGoals || !data.documentedExamples || !data.managerSupportExamples || !data.strengthsWeaknessesAnalysis) {
                            allFieldsFilled = false;
                        }
                        prompt += `Performance Tier: Poor Performance\n`;
                        prompt += `Confirmation employee didn't achieve all goals: ${data.employeeDidntAchieveGoals}\n`;
                        prompt += `Documented examples of behaviors/outcomes: ${data.documentedExamples}\n`;
                        prompt += `Manager support examples: ${data.managerSupportExamples}\n`;
                        prompt += `Strengths and weaknesses analysis: ${data.strengthsWeaknessesAnalysis}\n`;
                        break;
                    case 'belowExpectations':
                        data.projectsGoalsUnmet = document.getElementById('projectsGoalsUnmet')?.value.trim();
                        data.documentedBehaviorResults = document.getElementById('documentedBehaviorResults')?.value.trim();
                        data.managerSupportToImprove = document.getElementById('managerSupportToImprove')?.value.trim();
                        data.proposedTrainingPlan = document.getElementById('proposedTrainingPlan')?.value.trim();
                        data.skillsForFutureAdvancement = document.getElementById('skillsForFutureAdvancement')?.value.trim();
                        if (!data.projectsGoalsUnmet || !data.documentedBehaviorResults || !data.managerSupportToImprove || !data.proposedTrainingPlan || !data.skillsForFutureAdvancement) {
                            allFieldsFilled = false;
                        }
                        prompt += `Performance Tier: Below Expectations\n`;
                        prompt += `Projects/goals/initiatives where expectations were not met: ${data.projectsGoalsUnmet}\n`;
                        prompt += `Documented behavior/result examples that didn’t meet expectations: ${data.documentedBehaviorResults}\n`;
                        prompt += `Manager support examples to improve behavior: ${data.managerSupportToImprove}\n`;
                        prompt += `Proposed individual training plan: ${data.proposedTrainingPlan}\n`;
                        prompt += `Skills and experiences required for future advancement: ${data.skillsForFutureAdvancement}\n`;
                        break;
                    case 'meetExpectations':
                        data.accomplishedResponsibilities = document.getElementById('accomplishedResponsibilities')?.value.trim();
                        data.coreResponsibilities = document.getElementById('coreResponsibilities')?.value.trim();
                        data.additionalAchievements = document.getElementById('additionalAchievements')?.value.trim(); // Optional
                        data.justificationAdditional = document.getElementById('justificationAdditional')?.value.trim(); // Optional, depends on additionalAchievements
                        data.achievementsImpact = document.getElementById('achievementsImpact')?.value.trim();
                        if (!data.accomplishedResponsibilities || !data.coreResponsibilities || !data.achievementsImpact || (data.additionalAchievements && !data.justificationAdditional)) {
                            allFieldsFilled = false;
                        }
                        prompt += `Performance Tier: Meet Expectations\n`;
                        prompt += `Accomplished Responsibilities: ${data.accomplishedResponsibilities}\n`;
                        prompt += `Core Responsibilities: ${data.coreResponsibilities}\n`;
                        if (data.additionalAchievements) {
                            prompt += `Additional achievements: ${data.additionalAchievements}\n`;
                            prompt += `Justification for “additional” classification: ${data.justificationAdditional}\n`;
                        }
                        prompt += `Impact of these achievements: ${data.achievementsImpact}\n`;
                        break;
                    case 'exceedExpectations':
                        data.accomplishedResponsibilities = document.getElementById('accomplishedResponsibilities')?.value.trim();
                        data.additionalAchievements = document.getElementById('additionalAchievements')?.value.trim();
                        data.justificationAdditional = document.getElementById('justificationAdditional')?.value.trim();
                        data.achievementsImpact = document.getElementById('achievementsImpact')?.value.trim();
                        data.skillsForFutureAdvancement = document.getElementById('skillsForFutureAdvancement')?.value.trim();
                        if (!data.accomplishedResponsibilities || !data.additionalAchievements || !data.justificationAdditional || !data.achievementsImpact || !data.skillsForFutureAdvancement) {
                            allFieldsFilled = false;
                        }
                        prompt += `Performance Tier: Exceed Expectations\n`;
                        prompt += `Accomplished Responsibilities: ${data.accomplishedResponsibilities}\n`;
                        prompt += `Additional achievements: ${data.additionalAchievements}\n`;
                        prompt += `Justification for “additional” classification: ${data.justificationAdditional}\n`;
                        prompt += `Impact of these achievements: ${data.achievementsImpact}\n`;
                        prompt += `Skills and experiences required for future advancement: ${data.skillsForFutureAdvancement}\n`;
                        break;
                    case 'outstanding':
                        const subOption = document.getElementById('outstandingSubOption')?.value;
                        data.skillsForFutureAdvancement = document.getElementById('skillsForFutureAdvancement')?.value.trim();
                        if (!subOption || !data.skillsForFutureAdvancement) {
                             allFieldsFilled = false;
                        }
                        prompt += `Performance Tier: Outstanding\n`;
                        prompt += `Outstanding Sub-option: ${translations[currentLanguage][subOption]}\n`;

                        switch (subOption) {
                            case 'workedInRiskAreas':
                                data.missionDetails = document.getElementById('missionDetails')?.value.trim();
                                if (!data.missionDetails) allFieldsFilled = false;
                                prompt += `Mission Details: ${data.missionDetails}\n`;
                                break;
                            case 'createdInnovation':
                                data.solutionDescription = document.getElementById('solutionDescription')?.value.trim();
                                data.businessImpactMetrics = document.getElementById('businessImpactMetrics')?.value.trim();
                                if (!data.solutionDescription || !data.businessImpactMetrics) allFieldsFilled = false;
                                prompt += `Solution Description: ${data.solutionDescription}\n`;
                                prompt += `Business Impact Metrics: ${data.businessImpactMetrics}\n`;
                                break;
                            case 'exceededTarget':
                                data.targetSurpassMetrics = document.getElementById('targetSurpassMetrics')?.value.trim();
                                data.impactExceededTarget = document.getElementById('impactExceededTarget')?.value.trim();
                                if (!data.targetSurpassMetrics || !data.impactExceededTarget) allFieldsFilled = false;
                                prompt += `Target Surpass Metrics: ${data.targetSurpassMetrics}\n`;
                                prompt += `Impact of Exceeding Target: ${data.impactExceededTarget}\n`;
                                break;
                        }
                        prompt += `Skills and experiences required for future advancement: ${data.skillsForFutureAdvancement}\n`;
                        break;
                }

                if (!allFieldsFilled) {
                    displayMessage(translations[currentLanguage].fillAppraisalMandatoryFields, 'error', moduleSection);
                    return;
                }

                generateAppraisalBtn.disabled = true;
                generateAppraisalBtn.innerHTML = `${loaderIcon} ${translations[currentLanguage].generateFeedback}`;
                appraisalOutput.classList.add('hidden');

                let generatedFeedback;
                try {
                    generatedFeedback = await callGeminiApi(prompt);
                } catch (error) {
                    console.error("Error during API call for Appraisal Feedback:", error);
                    displayMessage(`${translations[currentLanguage].failedToGenerate} ${error.message}`, 'error', moduleSection);
                    generateAppraisalBtn.disabled = false;
                    generateAppraisalBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><path d="M14 2v6h6"></path><path d="M12 18V12"></path><path d="M9 15h6"></path></svg><span data-i18n="generateFeedback">${translations[currentLanguage].generateFeedback}</span>`;
                    return;
                }

                generateAppraisalBtn.disabled = false;
                generateAppraisalBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><path d="M14 2v6h6"></path><path d="M12 18V12"></path><path d="M9 15h6"></path></svg><span data-i18n="generateFeedback">${translations[currentLanguage].generateFeedback}</span>`;


                if (generatedFeedback) {
                    appraisalOutput.innerHTML = `<h3 class="mb-4" data-i18n="generatedFeedback">Generated Feedback:</h3>`;
                    const feedbackItem = document.createElement('div');
                    feedbackItem.className = 'output-item';
                    feedbackItem.innerHTML = `
                        <p>${generatedFeedback}</p>
                        <button class="copy-button">${copyIcon} <span data-i18n="copyToClipboard">${translations[currentLanguage].copyToClipboard}</span></button>
                    `;
                    feedbackItem.querySelector('.copy-button').onclick = (e) => {
                        e.preventDefault();
                        copyTextToClipboard(generatedFeedback, e.currentTarget);
                    };
                    appraisalOutput.appendChild(feedbackItem);
                    appraisalOutput.classList.remove('hidden');
                    applyTranslations();
                } else {
                    displayMessage(translations[currentLanguage].failedToGenerate + ' appraisal feedback.', 'error', moduleSection);
                }
            };

            // Initial render of inputs based on default selection (or empty if none)
            renderTierInputs(performanceTierSelect.value);
        }

        /**
         * Renders the Performance Notes module.
         */
        function renderPerformanceNote() {
            const appContent = document.getElementById('app-content');
            appContent.innerHTML = `
                <section class="module-section">
                    <h3 class="text-2xl font-bold mb-6 text-center text-linkedin-blue-dark" data-i18n="performanceNotes">Performance Notes</h3>
                    <div class="input-group">
                        <label for="dateOfObservation" data-i18n="dateOfObservation">Date of Observation</label>
                        <input type="date" id="dateOfObservation" class="rounded-md">
                    </div>
                    <div class="input-group">
                        <label for="feedbackType" data-i18n="feedbackType">Feedback Type</label>
                        <select id="feedbackType" class="rounded-md">
                            <option value="" data-i18n="selectAnOption">${translations[currentLanguage].selectAnOption}</option>
                            <option value="recognition" data-i18n="recognition">${translations[currentLanguage].recognition}</option>
                            <option value="development" data-i18n="development">${translations[currentLanguage].development}</option>
                            <option value="general" data-i18n="general">${translations[currentLanguage].general}</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="observedBehaviorAction" data-i18n="observedBehaviorAction">Observed Behavior/Action</label>
                        <textarea id="observedBehaviorAction" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderObservedBehaviorAction}"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="contextSituation" data-i18n="contextSituation">Context/Situation</label>
                        <textarea id="contextSituation" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderContextSituation}"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="impactOutcome" data-i18n="impactOutcome">Impact/Outcome</label>
                        <textarea id="impactOutcome" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderImpactOutcome}"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="sentimentIndicator" data-i18n="sentimentIndicator">Sentiment Indicator</label>
                        <select id="sentimentIndicator" class="rounded-md">
                            <option value="" data-i18n="selectAnOption">${translations[currentLanguage].selectAnOption}</option>
                            <option value="positive" data-i18n="positive">${translations[currentLanguage].positive}</option>
                            <option value="negative" data-i18n="negative">${translations[currentLanguage].negative}</option>
                            <option value="neutral" data-i18n="neutral">${translations[currentLanguage].neutral}</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="alignmentGoalsValues" data-i18n="alignmentGoalsValues">Alignment with Goals/Values (Optional)</label>
                        <textarea id="alignmentGoalsValues" rows="2" class="rounded-md" placeholder="${translations[currentLanguage].placeholderAlignmentGoalsValues}"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="nextSteps" data-i18n="nextSteps">Next Steps (Optional)</label>
                        <textarea id="nextSteps" rows="2" class="rounded-md" placeholder="${translations[currentLanguage].placeholderNextSteps}"></textarea>
                    </div>
                    <button id="generatePerformanceNoteBtn" class="button-generate">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><path d="M14 2v6h6"></path><path d="M12 18V12"></path><path d="M9 15h6"></path></svg>
                        <span data-i18n="generatePerformanceNote">Generate Performance Note</span>
                    </button>
                    <div id="performanceNoteOutput" class="output-area hidden">
                        <h3 class="mb-4" data-i18n="generatedNote">Generated Note:</h3>
                    </div>
                </section>
            `;
            applyTranslations();

            const generateButton = document.getElementById('generatePerformanceNoteBtn');
            const performanceNoteOutput = document.getElementById('performanceNoteOutput');
            const dateOfObservationInput = document.getElementById('dateOfObservation');
            const feedbackTypeSelect = document.getElementById('feedbackType');
            const observedBehaviorActionInput = document.getElementById('observedBehaviorAction');
            const contextSituationInput = document.getElementById('contextSituation');
            const impactOutcomeInput = document.getElementById('impactOutcome');
            const sentimentIndicatorSelect = document.getElementById('sentimentIndicator');
            const alignmentGoalsValuesInput = document.getElementById('alignmentGoalsValues');
            const nextStepsInput = document.getElementById('nextSteps');
            const moduleSection = appContent.querySelector('.module-section');


            generateButton.onclick = async () => {
                const dateOfObservation = dateOfObservationInput.value.trim();
                const feedbackType = feedbackTypeSelect.value;
                const observedBehaviorAction = observedBehaviorActionInput.value.trim();
                const contextSituation = contextSituationInput.value.trim();
                const impactOutcome = impactOutcomeInput.value.trim();
                const sentimentIndicator = sentimentIndicatorSelect.value;
                const alignmentGoalsValues = alignmentGoalsValuesInput.value.trim();
                const nextSteps = nextStepsInput.value.trim();

                if (!dateOfObservation || !feedbackType || !observedBehaviorAction || !contextSituation || !impactOutcome || !sentimentIndicator) {
                    displayMessage(translations[currentLanguage].fillNoteMandatoryFields, 'error', moduleSection);
                    return;
                }

                generateButton.disabled = true;
                generateButton.innerHTML = `${loaderIcon} ${translations[currentLanguage].generatePerformanceNote}`;
                performanceNoteOutput.classList.add('hidden');

                let prompt = `As an HR assistant, draft a performance note based on the following details, considering the user's language preference (${currentLanguage}):\n\n`;
                prompt += `Date of Observation: ${dateOfObservation}\n`;
                prompt += `Feedback Type: ${feedbackType}\n`;
                prompt += `Observed Behavior/Action: ${observedBehaviorAction}\n`;
                prompt += `Context/Situation: ${contextSituation}\n`;
                prompt += `Impact/Outcome: ${impactOutcome}\n`;
                prompt += `Sentiment Indicator: ${sentimentIndicator}\n`;
                if (alignmentGoalsValues) {
                    prompt += `Alignment with Goals/Values: ${alignmentGoalsValues}\n`;
                }
                if (nextSteps) {
                    prompt += `Next Steps: ${nextSteps}\n`;
                }
                prompt += `The note should be concise and professional.`;

                let generatedNote;
                try {
                    generatedNote = await callGeminiApi(prompt);
                } catch (error) {
                    console.error("Error during API call for Performance Note:", error);
                    displayMessage(`${translations[currentLanguage].failedToGenerate} ${error.message}`, 'error', moduleSection);
                    generateButton.disabled = false;
                    generateButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><path d="M14 2v6h6"></path><path d="M12 18V12"></path><path d="M9 15h6"></path></svg><span data-i18n="generatePerformanceNote">${translations[currentLanguage].generatePerformanceNote}</span>`;
                    return;
                }

                generateButton.disabled = false;
                generateButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><path d="M14 2v6h6"></path><path d="M12 18V12"></path><path d="M9 15h6"></path></svg><span data-i18n="generatePerformanceNote">${translations[currentLanguage].generatePerformanceNote}</span>`;


                if (generatedNote) {
                    performanceNoteOutput.innerHTML = `<h3 class="mb-4" data-i18n="generatedNote">Generated Note:</h3>`;
                    const noteItem = document.createElement('div');
                    noteItem.className = 'output-item';
                    noteItem.innerHTML = `
                        <p>${generatedNote}</p>
                        <button class="copy-button">${copyIcon} <span data-i18n="copyToClipboard">${translations[currentLanguage].copyToClipboard}</span></button>
                    `;
                    noteItem.querySelector('.copy-button').onclick = (e) => {
                        e.preventDefault();
                        copyTextToClipboard(generatedNote, e.currentTarget);
                    };
                    performanceNoteOutput.appendChild(noteItem);
                    performanceNoteOutput.classList.remove('hidden');
                    applyTranslations();
                } else {
                    displayMessage(translations[currentLanguage].failedToGenerate + ' performance note.', 'error', moduleSection);
                }
            };
        }

        /**
         * Renders the Individual Development Plan (IDP) module.
         */
        function renderIdp() {
            const appContent = document.getElementById('app-content');
            appContent.innerHTML = `
                <section class="module-section">
                    <h3 class="text-2xl font-bold mb-6 text-center text-linkedin-blue-dark" data-i18n="idp">Individual Development Plan</h3>
                    <div class="input-group">
                        <label for="employeeCurrentRole" data-i18n="employeeCurrentRole">Employee's Current Role</label>
                        <input type="text" id="employeeCurrentRole" class="rounded-md" placeholder="${translations[currentLanguage].employeeCurrentRole}">
                    </div>
                    <div class="input-group">
                        <label for="currentSkillsStrengths" data-i18n="currentSkillsStrengths">Current Skills and Strengths</label>
                        <textarea id="currentSkillsStrengths" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].currentSkillsStrengths}"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="desiredSkillsDevelopment" data-i18n="desiredSkillsDevelopment">Desired Skills/Areas for Development</label>
                        <textarea id="desiredSkillsDevelopment" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].desiredSkillsDevelopment}"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="careerAspirations" data-i18n="careerAspirations">Career Aspirations</label>
                        <textarea id="careerAspirations" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].careerAspirations}"></textarea>
                    </div>

                    <h4 class="text-xl font-semibold mb-4 text-linkedin-blue-dark" data-i18n="developmentActivities">Development Activities</h4>
                    <div class="input-group">
                        <label for="developmentTarget" data-i18n="developmentTarget">Development Target Skill/Competency/Goal</label>
                        <input type="text" id="developmentTarget" class="rounded-md" placeholder="${translations[currentLanguage].placeholderDevelopmentTarget}">
                    </div>
                    <div id="developmentActivitiesContainer">
                        <!-- Dynamic activity inputs will be added here -->
                    </div>
                    <button id="addActivityBtn" class="button-generate mt-4 mb-6 !w-auto">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                        <span data-i18n="addActivity">Add</span>
                    </button>

                    <h4 class="text-xl font-semibold mb-4 text-linkedin-blue-dark" data-i18n="supportResources">Support & Resources</h4>
                    <div class="input-group">
                        <label for="managerOrgSupport" data-i18n="managerOrgSupport">Manager/Org Support Required</label>
                        <textarea id="managerOrgSupport" rows="2" class="rounded-md" placeholder="${translations[currentLanguage].placeholderManagerOrgSupport}"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="budgetTimeEstimates" data-i18n="budgetTimeEstimates">Budget/Time Estimates</label>
                        <textarea id="budgetTimeEstimates" rows="2" class="rounded-md" placeholder="${translations[currentLanguage].placeholderBudgetTimeEstimates}"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="toolsSystemsNeeded" data-i18n="toolsSystemsNeeded">Tools/Systems Needed</label>
                        <textarea id="toolsSystemsNeeded" rows="2" class="rounded-md" placeholder="${translations[currentLanguage].placeholderToolsSystemsNeeded}"></textarea>
                    </div>

                    <button id="generateIdpBtn" class="button-generate">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><path d="M14 2v6h6"></path><path d="M12 18V12"></path><path d="M9 15h6"></path></svg>
                        <span data-i18n="generateIdp">Generate IDP</span>
                    </button>
                    <div id="idpOutput" class="output-area hidden">
                        <h3 class="mb-4" data-i18n="generatedIdpDraft">Generated IDP Draft:</h3>
                    </div>
                </section>
            `;
            applyTranslations();

            const addActivityBtn = document.getElementById('addActivityBtn');
            const developmentActivitiesContainer = document.getElementById('developmentActivitiesContainer');
            const generateIdpBtn = document.getElementById('generateIdpBtn');
            const idpOutput = document.getElementById('idpOutput');
            const employeeCurrentRoleInput = document.getElementById('employeeCurrentRole');
            const currentSkillsStrengthsInput = document.getElementById('currentSkillsStrengths');
            const desiredSkillsDevelopmentInput = document.getElementById('desiredSkillsDevelopment');
            const careerAspirationsInput = document.getElementById('careerAspirations');
            const developmentTargetInput = document.getElementById('developmentTarget');
            const managerOrgSupportInput = document.getElementById('managerOrgSupport');
            const budgetTimeEstimatesInput = document.getElementById('budgetTimeEstimates');
            const toolsSystemsNeededInput = document.getElementById('toolsSystemsNeeded');
            const moduleSection = appContent.querySelector('.module-section');


            let activityCounter = 0;

            /**
             * Adds a new development activity input group.
             */
            function addDevelopmentActivity() {
                activityCounter++;
                const activityDiv = document.createElement('div');
                activityDiv.className = 'activity-group border border-linkedin-gray-100 p-4 rounded-md mb-4 relative';
                activityDiv.innerHTML = `
                    <button class="remove-activity-btn absolute top-2 right-2 text-linkedin-red hover:text-linkedin-blue-dark" title="Remove Activity">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-x-circle"><circle cx="12" cy="12" r="10"></circle><line x1="15" y1="9" x2="9" y2="15"></line><line x1="9" y1="9" x2="15" y2="15"></line></svg>
                    </button>
                    <div class="input-group">
                        <label for="activityType-${activityCounter}" data-i18n="activityTypeLabel">Activity Type</label>
                        <select id="activityType-${activityCounter}" class="rounded-md activity-type">
                            <option value="" data-i18n="selectAnOption">${translations[currentLanguage].selectAnOption}</option>
                            <option value="trainingCourses" data-i18n="trainingCourses">${translations[currentLanguage].trainingCourses}</option>
                            <option value="workshopsCertifications" data-i18n="workshopsCertifications">${translations[currentLanguage].workshopsCertifications}</option>
                            <option value="jobShadowingMentoring" data-i18n="jobShadowingMentoring">${translations[currentLanguage].jobShadowingMentoring}</option>
                            <option value="stretchAssignments" data-i18n="stretchAssignments">${translations[currentLanguage].stretchAssignments}</option>
                            <option value="researchTopics" data-i18n="researchTopics">${translations[currentLanguage].researchTopics}</option>
                            <option value="networking" data-i18n="networking">${translations[currentLanguage].networking}</option>
                        </select>
                    </div>
                    <div class="input-group">
                        <label for="activityDescription-${activityCounter}" data-i18n="detailedDescription">Detailed Description</label>
                        <textarea id="activityDescription-${activityCounter}" rows="2" class="rounded-md activity-description" placeholder="${translations[currentLanguage].placeholderActivityDescription}"></textarea>
                    </div>
                `;
                developmentActivitiesContainer.appendChild(activityDiv);
                applyTranslations();

                // Add event listener for remove button
                activityDiv.querySelector('.remove-activity-btn').onclick = () => {
                    activityDiv.remove();
                };
            }

            // Add first activity automatically on load
            addDevelopmentActivity();

            addActivityBtn.onclick = addDevelopmentActivity;

            generateIdpBtn.onclick = async () => {
                const employeeCurrentRole = employeeCurrentRoleInput.value.trim();
                const currentSkillsStrengths = currentSkillsStrengthsInput.value.trim();
                const desiredSkillsDevelopment = desiredSkillsDevelopmentInput.value.trim();
                const careerAspirations = careerAspirationsInput.value.trim();
                const developmentTarget = developmentTargetInput.value.trim();
                const managerOrgSupport = managerOrgSupportInput.value.trim();
                const budgetTimeEstimates = budgetTimeEstimatesInput.value.trim();
                const toolsSystemsNeeded = toolsSystemsNeededInput.value.trim();

                const activities = [];
                let allActivitiesFilled = true;
                document.querySelectorAll('.activity-group').forEach(activityDiv => {
                    const type = activityDiv.querySelector('.activity-type')?.value;
                    const description = activityDiv.querySelector('.activity-description')?.value.trim();
                    if (type && description) {
                        activities.push({ type: translations[currentLanguage][type], description });
                    } else {
                        allActivitiesFilled = false;
                    }
                });

                if (!employeeCurrentRole || !currentSkillsStrengths || !desiredSkillsDevelopment || !careerAspirations || !developmentTarget || !allActivitiesFilled || !managerOrgSupport || !budgetTimeEstimates || !toolsSystemsNeeded) {
                    displayMessage(translations[currentLanguage].fillIdpMandatoryFields, 'error', moduleSection);
                    return;
                }

                generateIdpBtn.disabled = true;
                generateIdpBtn.innerHTML = `${loaderIcon} ${translations[currentLanguage].generateIdp}`;
                idpOutput.classList.add('hidden');

                let prompt = `As an HR assistant, draft an Individual Development Plan (IDP) based on the following details, formatted for ${currentLanguage}:\n\n`;
                prompt += `Employee's Current Role: ${employeeCurrentRole}\n`;
                prompt += `Current Skills and Strengths: ${currentSkillsStrengths}\n`;
                prompt += `Desired Skills/Areas for Development: ${desiredSkillsDevelopment}\n`;
                prompt += `Career Aspirations: ${careerAspirations}\n\n`;
                prompt += `Development Target Skill/Competency/Goal: ${developmentTarget}\n\n`;
                prompt += `Development Activities:\n`;
                activities.forEach(activity => {
                    prompt += `- Type: ${activity.type}, Description: ${activity.description}\n`;
                });
                prompt += `\nSupport & Resources:\n`;
                prompt += `Manager/Org Support Required: ${managerOrgSupport}\n`;
                prompt += `Budget/Time Estimates: ${budgetTimeEstimates}\n`;
                prompt += `Tools/Systems Needed: ${toolsSystemsNeeded}\n`;
                prompt += `The IDP should be comprehensive and actionable.`;

                let generatedIdp;
                try {
                    generatedIdp = await callGeminiApi(prompt);
                } catch (error) {
                    console.error("Error during API call for IDP:", error);
                    displayMessage(`${translations[currentLanguage].failedToGenerate} ${error.message}`, 'error', moduleSection);
                    generateIdpBtn.disabled = false;
                    generateIdpBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><path d="M14 2v6h6"></path><path d="M12 18V12"></path><path d="M9 15h6"></path></svg><span data-i18n="generateIdp">${translations[currentLanguage].generateIdp}</span>`;
                    return;
                }

                generateIdpBtn.disabled = false;
                generateIdpBtn.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><path d="M14 2v6h6"></path><path d="M12 18V12"></path><path d="M9 15h6"></path></svg><span data-i18n="generateIdp">${translations[currentLanguage].generateIdp}</span>`;


                if (generatedIdp) {
                    idpOutput.innerHTML = `<h3 class="mb-4" data-i18n="generatedIdpDraft">Generated IDP Draft:</h3>`;
                    const idpItem = document.createElement('div');
                    idpItem.className = 'output-item';
                    idpItem.innerHTML = `
                        <p>${generatedIdp}</p>
                        <button class="copy-button">${copyIcon} <span data-i18n="copyToClipboard">${translations[currentLanguage].copyToClipboard}</span></button>
                    `;
                    idpItem.querySelector('.copy-button').onclick = (e) => {
                        e.preventDefault();
                        copyTextToClipboard(generatedIdp, e.currentTarget);
                    };
                    idpOutput.appendChild(idpItem);
                    idpOutput.classList.remove('hidden');
                    applyTranslations();
                } else {
                    displayMessage(translations[currentLanguage].failedToGenerate + ' IDP.', 'error', moduleSection);
                }
            };
        }

        /**
         * Renders the Periodic Feedback (Regular Check-in) module.
         */
        function renderRegularCheckIn() {
            const appContent = document.getElementById('app-content');
            appContent.innerHTML = `
                <section class="module-section">
                    <h3 class="text-2xl font-bold mb-6 text-center text-linkedin-blue-dark" data-i18n="regularCheckInFeedback">Periodic Feedback</h3>
                    <div class="input-group">
                        <label for="dateOfCheckIn" data-i18n="dateOfCheckIn">Date of Check-in</label>
                        <input type="date" id="dateOfCheckIn" class="rounded-md">
                    </div>
                    <div class="input-group">
                        <label for="progressOnGoals" data-i18n="progressOnGoals">Progress on Goals/Projects</label>
                        <textarea id="progressOnGoals" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderProgressOnGoals}"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="challenges" data-i18n="challenges">Challenges/Roadblocks (Optional)</label>
                        <textarea id="challenges" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderChallenges}"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="accomplishments" data-i18n="accomplishments">Accomplishments/Highlights (Optional)</label>
                        <textarea id="accomplishments" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderAccomplishments}"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="managerObservations" data-i18n="managerObservations">Manager Observations/Feedback (Optional)</label>
                        <textarea id="managerObservations" rows="3" class="rounded-md" placeholder="${translations[currentLanguage].placeholderManagerObservations}"></textarea>
                    </div>
                    <div class="input-group">
                        <label for="nextStepsCheckIn" data-i18n="nextStepsCheckIn">Next Steps/Action Items (Optional)</label>
                        <textarea id="nextStepsCheckIn" rows="2" class="rounded-md" placeholder="${translations[currentLanguage].placeholderNextStepsCheckIn}"></textarea>
                    </div>
                    <button id="generateCheckInFeedbackBtn" class="button-generate">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><path d="M14 2v6h6"></path><path d="M12 18V12"></path><path d="M9 15h6"></path></svg>
                        <span data-i18n="generateCheckInFeedback">Generate Periodic Feedback</span>
                    </button>
                    <div id="checkInOutput" class="output-area hidden">
                        <h3 class="mb-4" data-i18n="generatedCheckInFeedback">Generated Periodic Feedback:</h3>
                    </div>
                </section>
            `;
            applyTranslations();

            const generateButton = document.getElementById('generateCheckInFeedbackBtn');
            const checkInOutput = document.getElementById('checkInOutput');
            const dateOfCheckInInput = document.getElementById('dateOfCheckIn');
            const progressOnGoalsInput = document.getElementById('progressOnGoals');
            const challengesInput = document.getElementById('challenges');
            const accomplishmentsInput = document.getElementById('accomplishments');
            const managerObservationsInput = document.getElementById('managerObservations');
            const nextStepsCheckInInput = document.getElementById('nextStepsCheckIn');
            const moduleSection = appContent.querySelector('.module-section');


            generateButton.onclick = async () => {
                const dateOfCheckIn = dateOfCheckInInput.value.trim();
                const progressOnGoals = progressOnGoalsInput.value.trim();
                const challenges = challengesInput.value.trim();
                const accomplishments = accomplishmentsInput.value.trim();
                const managerObservations = managerObservationsInput.value.trim();
                const nextStepsCheckIn = nextStepsCheckInInput.value.trim();

                if (!dateOfCheckIn || !progressOnGoals) {
                    displayMessage(translations[currentLanguage].fillCheckInMandatoryFields, 'error', moduleSection);
                    return;
                }

                generateButton.disabled = true;
                generateButton.innerHTML = `${loaderIcon} ${translations[currentLanguage].generateCheckInFeedback}`;
                checkInOutput.classList.add('hidden');

                let prompt = `As an HR assistant, draft a periodic feedback (regular check-in) summary based on the following details, formatted for ${currentLanguage}:\n\n`;
                prompt += `Date of Check-in: ${dateOfCheckIn}\n`;
                prompt += `Progress on Goals/Projects: ${progressOnGoals}\n`;
                if (challenges) {
                    prompt += `Challenges/Roadblocks: ${challenges}\n`;
                }
                if (accomplishments) {
                    prompt += `Accomplishments/Highlights: ${accomplishments}\n`;
                }
                if (managerObservations) {
                    prompt += `Manager Observations/Feedback: ${managerObservations}\n`;
                }
                if (nextStepsCheckIn) {
                    prompt += `Next Steps/Action Items: ${nextStepsCheckIn}\n`;
                }
                prompt += `The feedback should be constructive and concise.`;

                let generatedFeedback;
                try {
                    generatedFeedback = await callGeminiApi(prompt);
                } catch (error) {
                    console.error("Error during API call for Regular Check-in:", error);
                    displayMessage(`${translations[currentLanguage].failedToGenerate} ${error.message}`, 'error', moduleSection);
                    generateButton.disabled = false;
                    generateButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><path d="M14 2v6h6"></path><path d="M12 18V12"></path><path d="M9 15h6"></path></svg><span data-i18n="generateCheckInFeedback">${translations[currentLanguage].generateCheckInFeedback}</span>`;
                    return;
                }

                generateButton.disabled = false;
                generateButton.innerHTML = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><path d="M14 2v6h6"></path><path d="M12 18V12"></path><path d="M9 15h6"></path></svg><span data-i18n="generateCheckInFeedback">${translations[currentLanguage].generateCheckInFeedback}</span>`;


                if (generatedFeedback) {
                    checkInOutput.innerHTML = `<h3 class="mb-4" data-i18n="generatedCheckInFeedback">Generated Periodic Feedback:</h3>`;
                    const feedbackItem = document.createElement('div');
                    feedbackItem.className = 'output-item';
                    feedbackItem.innerHTML = `
                        <p>${generatedFeedback}</p>
                        <button class="copy-button">${copyIcon} <span data-i18n="copyToClipboard">${translations[currentLanguage].copyToClipboard}</span></button>
                    `;
                    feedbackItem.querySelector('.copy-button').onclick = (e) => {
                        e.preventDefault();
                        copyTextToClipboard(generatedFeedback, e.currentTarget);
                    };
                    checkInOutput.appendChild(feedbackItem);
                    checkInOutput.classList.remove('hidden');
                    applyTranslations();
                } else {
                    displayMessage(translations[currentLanguage].failedToGenerate + ' periodic feedback.', 'error', moduleSection);
                }
            };
        }


        /**
         * Renders the References module (now Learn & Grow with subcategories).
         */
        function renderReferences() {
            const appContent = document.getElementById('app-content');
            appContent.innerHTML = `
                <section class="module-section">
                    <h3 class="text-2xl font-bold mb-6 text-center text-linkedin-blue-dark" data-i18n="learnGrowBtn">Learn & Grow</h3>
                    <p class="mb-4 text-linkedin-text-dark" data-i18n="learnGrowIntroContent"></p>

                    <div class="subcategory-section mb-8">
                        <button class="flex items-center justify-between w-full text-left py-2 px-4 rounded-md bg-linkedin-blue-light hover:bg-linkedin-blue-primary hover:text-white transition-colors duration-200 group" id="togglePerformancePlanning">
                            <h4 class="text-xl font-semibold text-linkedin-blue-dark group-hover:text-white m-0 p-0" data-i18n="performancePlanningSubcategory"></h4>
                            <svg id="arrowIcon" class="w-6 h-6 transform transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                        </button>
                        <div id="performancePlanningContentArea" class="mt-4">
                            <p class="mb-4 text-linkedin-text-medium" data-i18n="performancePlanningContent"></p>

                            <div class="articles-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                <!-- Article Card 1 -->
                                <div class="article-card">
                                    <div class="article-icon">📚</div>
                                    <h5 class="article-title" data-i18n="reference1Title"></h5>
                                    <p class="article-description" data-i18n="reference1Description"></p>
                                    <a href="https://hbr.org/2021/01/how-to-give-performance-reviews" target="_blank" class="article-link" data-i18n="readMore"></a>
                                </div>
                                <!-- Article Card 2 -->
                                <div class="article-card">
                                    <div class="article-icon">💡</div>
                                    <h5 class="article-title" data-i18n="reference2Title"></h5>
                                    <p class="article-description" data-i18n="reference2Description"></p>
                                    <a href="https://www.forbes.com/sites/forbeshumanresourcescouncil/2023/07/28/the-importance-of-employee-performance-reviews/?sh=5f0f3e6a4b1f" target="_blank" class="article-link" data-i18n="readMore"></a>
                                </div>
                                <!-- Article Card 3 -->
                                <div class="article-card">
                                    <div class="article-icon">📊</div>
                                    <h5 class="article-title" data-i18n="reference3Title"></h5>
                                    <p class="article-description" data-i18n="reference3Description"></p>
                                    <a href="https://www.shrm.org/resourcesandtools/tools-and-samples/hr-qa/pages/whatisperformancemanagement.aspx" target="_blank" class="article-link" data-i18n="readMore"></a>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            `;
            applyTranslations(); // Apply translations to newly rendered elements

            const toggleButton = document.getElementById('togglePerformancePlanning');
            const contentArea = document.getElementById('performancePlanningContentArea');
            const arrowIcon = document.getElementById('arrowIcon');

            // Initial state: collapsed by default
            contentArea.classList.add('hidden');
            arrowIcon.classList.remove('rotate-180'); // Ensure arrow points down

            toggleButton.onclick = () => {
                contentArea.classList.toggle('hidden');
                arrowIcon.classList.toggle('rotate-180'); // Rotate arrow up when expanded
            };
        }

        /**
         * Attaches event listeners for navigation buttons.
         */
        function attachNavListeners() {
            const navButtons = document.querySelectorAll('.nav-button');
            navButtons.forEach(button => {
                button.addEventListener('click', (event) => {
                    // Remove active class from all buttons
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    // Add active class to the clicked button
                    event.currentTarget.classList.add('active');

                    // Determine which module to render
                    switch (event.currentTarget.id) {
                        case 'nav-smartGoal':
                            activeModuleRenderer = renderSmartGoalDrafting;
                            break;
                        case 'nav-performanceAppraisal':
                            activeModuleRenderer = renderPerformanceAppraisal;
                            break;
                        case 'nav-performanceNote':
                            activeModuleRenderer = renderPerformanceNote;
                            break;
                        case 'nav-idp':
                            activeModuleRenderer = renderIdp;
                            break;
                        case 'nav-regularCheckIn':
                            activeModuleRenderer = renderRegularCheckIn;
                            break;
                        case 'nav-references': // This ID remains the same
                            activeModuleRenderer = renderReferences;
                            break;
                        default:
                            activeModuleRenderer = renderSmartGoalDrafting; // Default to SMART Goals
                    }
                    activeModuleRenderer(); // Render the module
                });
            });
        }

        /**
         * Attaches event listeners for language switcher buttons.
         */
        function attachLangListeners() {
            document.getElementById('lang-en').addEventListener('click', () => setLanguage('en'));
            document.getElementById('lang-ar').addEventListener('click', () => setLanguage('ar'));
        }

        // Initial setup on DOMContentLoaded
        document.addEventListener('DOMContentLoaded', () => {
            setLanguage(currentLanguage); // Apply initial language
            attachNavListeners();
            attachLangListeners();

            // Set initial active nav button and render default module
            const defaultNavButton = document.getElementById('nav-smartGoal');
            if (defaultNavButton) {
                defaultNavButton.classList.add('active');
                renderSmartGoalDrafting(); // Render the default module
            }

            // Update logo src to a placeholder image if it's the original "Sudani_logo.png"
            const sudaniLogo = document.getElementById('sudani-logo');
            if (sudaniLogo && sudaniLogo.src.includes('Sudani_logo.png')) {
                sudaniLogo.src = 'https://placehold.co/100x45/004182/FFFFFF?text=Logo';
            }
        });

    </script>
</body>
</html>
